{"version":3,"file":"index.js","sources":["../../src/Tooltip/Tooltip.tsx"],"sourcesContent":["import React, {\n  type FC,\n  type PropsWithChildren,\n  type HTMLProps,\n  forwardRef,\n  useRef,\n  useState,\n  MutableRefObject,\n  ReactNode,\n  cloneElement,\n} from \"react\";\nimport Transition from \"react-transition-group/Transition\";\nimport { useMergeRefs } from \"use-callback-ref\";\n\nimport {\n  arrow,\n  flip,\n  FloatingPortal,\n  offset,\n  shift,\n  useFloating,\n  useHover,\n  useInteractions,\n  type Side,\n  type Placement,\n  useRole,\n} from \"@floating-ui/react-dom-interactions\";\n\nimport \"../../css/tooltip.css\";\nimport { useFloatingContext } from \"src/FloatingProvider\";\n\nconst Tooltip = forwardRef<HTMLDivElement, HTMLProps<HTMLDivElement>>(\n  function TooltipRefed({ className, children, ...props }, ref) {\n    return (\n      <div ref={ref} className=\"tooltip__wrapper\" {...props}>\n        <div className={className}>{children}</div>\n      </div>\n    );\n  }\n);\n\nexport type UseTooltipReturn = ReturnType<typeof useFloating> & {\n  getFloatingProps: ReturnType<typeof useInteractions>[\"getFloatingProps\"];\n  show: boolean;\n  getReferenceProps: ReturnType<typeof useInteractions>[\"getReferenceProps\"];\n  arrowRef: MutableRefObject<any>;\n};\n\nexport function useTooltip(placement?: Placement): UseTooltipReturn {\n  const [show, setShow] = useState(false);\n  const arrowRef = useRef(null);\n  const fl = useFloating({\n    middleware: [\n      offset(6),\n      flip(),\n      shift({ padding: { left: 8, right: 8 } }),\n      arrow({ element: arrowRef }),\n    ],\n    open: show,\n    onOpenChange: setShow,\n    placement,\n  });\n\n  const role = useRole(fl.context, { role: \"tooltip\" });\n  const hover = useHover(fl.context, {\n    delay: {\n      open: 500,\n      close: 0,\n    },\n    move: false,\n  });\n\n  const { getReferenceProps, getFloatingProps } = useInteractions([\n    role,\n    hover,\n  ]);\n\n  return {\n    ...fl,\n    getFloatingProps,\n    show,\n    getReferenceProps,\n    arrowRef,\n  };\n}\n\nconst TooltipWrapper: FC<\n  PropsWithChildren<\n    Omit<ReturnType<typeof useTooltip>, \"getReferenceProps\" | \"reference\">\n  > & {\n    root?: Parameters<typeof FloatingPortal>[0][\"root\"];\n  }\n> = ({\n  children,\n  x,\n  y,\n  floating,\n  show,\n  strategy,\n  getFloatingProps,\n  middlewareData,\n  arrowRef,\n  placement,\n  root: rootProvided,\n}) => {\n  const { x: arrowX, y: arrowY } = middlewareData.arrow || { x: 0, y: 0 };\n\n  const staticSide = {\n    top: \"bottom\",\n    right: \"left\",\n    bottom: \"top\",\n    left: \"right\",\n  }[placement.split(\"-\")[0]] as Side;\n\n  const modalContext = useFloatingContext();\n  const root: HTMLElement | null | undefined =\n    rootProvided ?? modalContext ? modalContext.rootRef.current : undefined;\n\n  return (\n    <Transition\n      in={show}\n      mountOnEnter\n      unmountOnExit\n      timeout={200}\n      nodeRef={floating}\n    >\n      {(state) => (\n        <FloatingPortal root={root}>\n          <Tooltip\n            ref={floating}\n            style={{\n              position: strategy,\n              top: y ?? 0,\n              left: x ?? 0,\n            }}\n            {...getFloatingProps({\n              className: `tooltip__body ${\n                state === \"exiting\" || state === \"exited\"\n                  ? \"tooltip--disappear\"\n                  : \"tooltip--appear\"\n              }`,\n            })}\n          >\n            {children}\n            <div\n              ref={arrowRef}\n              className=\"tooltip__arrow\"\n              style={{\n                left: arrowX != null ? `${arrowX}px` : \"\",\n                top: arrowY != null ? `${arrowY}px` : \"\",\n                right: \"\",\n                bottom: \"\",\n                [staticSide]: \"-4px\",\n              }}\n            />\n          </Tooltip>\n        </FloatingPortal>\n      )}\n    </Transition>\n  );\n};\n\nexport { TooltipWrapper as Tooltip };\n\nexport type WithTooltipProps = {\n  children: JSX.Element;\n  tooltip: ReactNode;\n  placement?: Placement;\n};\n\nexport const WithTooltip: FC<WithTooltipProps> = ({\n  children,\n  tooltip,\n  placement = \"top\",\n}) => {\n  const { getReferenceProps, reference, ...tt } = useTooltip(placement);\n\n  const ref = useMergeRefs([reference, (children as any).ref]);\n\n  return (\n    <>\n      {cloneElement(children, getReferenceProps({ ref, ...children.props }))}\n      <TooltipWrapper {...tt}>{tooltip}</TooltipWrapper>\n    </>\n  );\n};\n"],"names":["Tooltip","forwardRef","TooltipRefed","className","children","props","ref","div","useTooltip","placement","show","setShow","useState","arrowRef","useRef","fl","useFloating","middleware","offset","flip","shift","padding","left","right","arrow","element","open","onOpenChange","role","useRole","context","hover","useHover","delay","close","move","getReferenceProps","getFloatingProps","useInteractions","TooltipWrapper","x","y","floating","strategy","middlewareData","root","rootProvided","arrowX","arrowY","staticSide","top","bottom","split","modalContext","useFloatingContext","rootRef","current","undefined","Transition","in","mountOnEnter","unmountOnExit","timeout","nodeRef","state","FloatingPortal","style","position","WithTooltip","tooltip","reference","tt","useMergeRefs","cloneElement"],"mappings":"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"}