{"version":3,"file":"index.js","sources":["../../src/Tooltip/Tooltip.tsx"],"sourcesContent":["import React, {\n  cloneElement,\n  forwardRef,\n  useRef,\n  useState,\n  type ComponentProps,\n  type FC,\n  type HTMLProps,\n  type MutableRefObject,\n  type PropsWithChildren,\n  type ReactNode,\n} from \"react\";\nimport {\n  FloatingPortal,\n  arrow,\n  flip,\n  offset,\n  shift,\n  useFloating,\n  useHover,\n  useInteractions,\n  useMergeRefs,\n  useRole,\n  type Placement,\n  type Side,\n} from \"@floating-ui/react\";\nimport { Transition } from \"react-transition-group\";\n\nimport { useFloatingContext } from \"src/FloatingProvider\";\n\nconst Tooltip = forwardRef<HTMLDivElement, HTMLProps<HTMLDivElement>>(\n  function TooltipRefed({ className, children, ...props }, ref) {\n    return (\n      <div ref={ref} className=\"tooltip__wrapper\" {...props}>\n        <div className={className}>{children}</div>\n      </div>\n    );\n  }\n);\n\nexport type UseTooltipReturn = ReturnType<typeof useFloating> & {\n  getFloatingProps: ReturnType<typeof useInteractions>[\"getFloatingProps\"];\n  show: boolean;\n  getReferenceProps: ReturnType<typeof useInteractions>[\"getReferenceProps\"];\n  arrowRef: MutableRefObject<any>;\n};\n\nexport function useTooltip(placement?: Placement): UseTooltipReturn {\n  const [show, setShow] = useState(false);\n  const arrowRef = useRef(null);\n  const fl = useFloating({\n    middleware: [\n      offset(6),\n      flip(),\n      shift({ padding: { left: 8, right: 8 } }),\n      arrow({ element: arrowRef }),\n    ],\n    open: show,\n    onOpenChange: setShow,\n    placement,\n  });\n\n  const role = useRole(fl.context, { role: \"tooltip\" });\n  const hover = useHover(fl.context, {\n    delay: {\n      open: 500,\n      close: 0,\n    },\n    move: false,\n  });\n\n  const { getReferenceProps, getFloatingProps } = useInteractions([\n    role,\n    hover,\n  ]);\n\n  return {\n    ...fl,\n    getFloatingProps,\n    show,\n    getReferenceProps,\n    arrowRef,\n  };\n}\n\nconst TooltipWrapper: FC<\n  PropsWithChildren<\n    Omit<ReturnType<typeof useTooltip>, \"getReferenceProps\" | \"reference\">\n  > & {\n    root?: ComponentProps<typeof FloatingPortal>[\"root\"];\n    portalId?: ComponentProps<typeof FloatingPortal>[\"id\"];\n  }\n> = ({\n  children,\n  x,\n  y,\n  floating,\n  show,\n  strategy,\n  getFloatingProps,\n  middlewareData,\n  arrowRef,\n  placement,\n  root: rootProvided,\n  portalId,\n}) => {\n  const { x: arrowX, y: arrowY } = middlewareData.arrow || { x: 0, y: 0 };\n  const floatingRef = useRef<any>(null);\n\n  const staticSide = {\n    top: \"bottom\",\n    right: \"left\",\n    bottom: \"top\",\n    left: \"right\",\n  }[placement.split(\"-\")[0]] as Side;\n\n  const { root, id } = useFloatingContext({\n    root: rootProvided,\n    portalId,\n    fallbackPortalId: \"--cui-tooltip-portal\",\n  });\n\n  return (\n    <FloatingPortal root={root} id={id}>\n      <Transition\n        in={show}\n        mountOnEnter\n        unmountOnExit\n        timeout={200}\n        nodeRef={floatingRef}\n      >\n        {(state) => (\n          <Tooltip\n            ref={(r) => {\n              floating(r);\n              floatingRef.current = r;\n            }}\n            style={{\n              position: strategy,\n              top: y ?? 0,\n              left: x ?? 0,\n            }}\n            {...getFloatingProps({\n              className: `tooltip__body ${\n                state === \"exiting\" || state === \"exited\"\n                  ? \"tooltip--disappear\"\n                  : \"tooltip--appear\"\n              }`,\n            })}\n          >\n            {children}\n            <div\n              ref={arrowRef}\n              className=\"tooltip__arrow\"\n              style={{\n                left: arrowX != null ? `${arrowX}px` : \"\",\n                top: arrowY != null ? `${arrowY}px` : \"\",\n                right: \"\",\n                bottom: \"\",\n                [staticSide]: \"-4px\",\n              }}\n            />\n          </Tooltip>\n        )}\n      </Transition>\n    </FloatingPortal>\n  );\n};\n\nexport { TooltipWrapper as Tooltip };\n\nexport type WithTooltipProps = {\n  children: JSX.Element;\n  tooltip: ReactNode;\n  placement?: Placement;\n};\n\nexport const WithTooltip: FC<WithTooltipProps> = forwardRef(\n  ({ children, tooltip, placement = \"top\", ...props }, forwardedRef) => {\n    const { getReferenceProps, reference, ...tt } = useTooltip(placement);\n\n    const ref = useMergeRefs([reference, forwardedRef, (children as any).ref]);\n\n    return (\n      <>\n        {cloneElement(\n          children,\n          getReferenceProps({ ref, ...children.props, ...props })\n        )}\n        <TooltipWrapper {...tt}>{tooltip}</TooltipWrapper>\n      </>\n    );\n  }\n);\n\nWithTooltip.displayName = \"WithTooltip\";\n"],"names":["_extends","Tooltip","forwardRef","TooltipRefed","ref","className","children","props","React","div","useTooltip","placement","useState","show","setShow","arrowRef","useRef","fl","useFloating","middleware","offset","flip","shift","padding","left","right","arrow","element","open","onOpenChange","role","useRole","context","hover","useHover","delay","close","move","useInteractions","getReferenceProps","getFloatingProps","TooltipWrapper","x","y","floating","strategy","middlewareData","root","rootProvided","portalId","arrowX","arrowY","floatingRef","staticSide","top","bottom","split","useFloatingContext","fallbackPortalId","id","FloatingPortal","Transition","in","mountOnEnter","unmountOnExit","timeout","nodeRef","state","r","current","style","position","WithTooltip","forwardedRef","tooltip","reference","tt","useMergeRefs","createElement","Fragment","cloneElement","displayName"],"mappings":"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"}