{"version":3,"file":"index.js","sources":["../../src/Tooltip/Tooltip.tsx"],"sourcesContent":["import React, {\n  cloneElement,\n  forwardRef,\n  useMemo,\n  useRef,\n  useState,\n  type ComponentProps,\n  type FC,\n  type HTMLProps,\n  type MutableRefObject,\n  type PropsWithChildren,\n  type ReactNode,\n} from \"react\";\nimport {\n  FloatingPortal,\n  arrow,\n  flip,\n  offset,\n  shift,\n  useFloating,\n  useHover,\n  useInteractions,\n  useMergeRefs,\n  useRole,\n  type Placement,\n  type Side,\n} from \"@floating-ui/react\";\nimport { Transition } from \"react-transition-group\";\n\nimport { useFloatingContext } from \"src/FloatingProvider\";\n\nconst TooltipContent = forwardRef<HTMLDivElement, HTMLProps<HTMLDivElement>>(\n  function TooltipRefed({ className, children, ...props }, ref) {\n    return (\n      <div ref={ref} className=\"tooltip__wrapper\" {...props}>\n        <div className={className}>{children}</div>\n      </div>\n    );\n  }\n);\n\ntype UseTooltipReturn = ReturnType<typeof useFloating> & {\n  getFloatingProps: ReturnType<typeof useInteractions>[\"getFloatingProps\"];\n  show: boolean;\n  getReferenceProps: ReturnType<typeof useInteractions>[\"getReferenceProps\"];\n  arrowRef: MutableRefObject<any>;\n};\n\nfunction useTooltip(placement?: Placement): UseTooltipReturn {\n  const [show, setShow] = useState(false);\n  const arrowRef = useRef(null);\n  const fl = useFloating({\n    middleware: [\n      offset(6),\n      flip(),\n      shift({ padding: { left: 8, right: 8 } }),\n      arrow({ element: arrowRef }),\n    ],\n    open: show,\n    onOpenChange: setShow,\n    placement,\n  });\n\n  const role = useRole(fl.context, { role: \"tooltip\" });\n  const hover = useHover(fl.context, {\n    delay: {\n      open: 500,\n      close: 0,\n    },\n    move: false,\n  });\n\n  const { getReferenceProps, getFloatingProps } = useInteractions([\n    role,\n    hover,\n  ]);\n\n  return useMemo(\n    () => ({\n      ...fl,\n      getFloatingProps,\n      show,\n      getReferenceProps,\n      arrowRef,\n    }),\n    [getFloatingProps, show, getReferenceProps, arrowRef, fl]\n  );\n}\n\nconst TooltipWrapper: FC<\n  PropsWithChildren<\n    Omit<ReturnType<typeof useTooltip>, \"getReferenceProps\" | \"reference\">\n  > & {\n    root?: ComponentProps<typeof FloatingPortal>[\"root\"];\n    portalId?: ComponentProps<typeof FloatingPortal>[\"id\"];\n  }\n> = ({\n  children,\n  x,\n  y,\n  show,\n  strategy,\n  getFloatingProps,\n  middlewareData,\n  arrowRef,\n  placement,\n  root: rootProvided,\n  portalId,\n  refs,\n}) => {\n  const { x: arrowX, y: arrowY } = middlewareData.arrow || { x: 0, y: 0 };\n  const floatingRef = useRef<any>(null);\n\n  const staticSide = {\n    top: \"bottom\",\n    right: \"left\",\n    bottom: \"top\",\n    left: \"right\",\n  }[placement.split(\"-\")[0]] as Side;\n\n  const { root, id } = useFloatingContext({\n    root: rootProvided,\n    portalId,\n    fallbackPortalId: \"--cui-tooltip-portal\",\n  });\n  const ref = useMergeRefs([refs.setFloating, floatingRef]);\n\n  return (\n    <FloatingPortal root={root} id={id}>\n      <Transition\n        in={show}\n        mountOnEnter\n        unmountOnExit\n        timeout={200}\n        nodeRef={floatingRef}\n      >\n        {(state) => (\n          <TooltipContent\n            ref={ref}\n            style={{\n              position: strategy,\n              top: y ?? 0,\n              left: x ?? 0,\n            }}\n            {...getFloatingProps({\n              className: `tooltip__body ${\n                state === \"exiting\" || state === \"exited\"\n                  ? \"tooltip--disappear\"\n                  : \"tooltip--appear\"\n              }`,\n            })}\n          >\n            {children}\n            <div\n              ref={arrowRef}\n              className=\"tooltip__arrow\"\n              style={{\n                left: arrowX != null ? `${arrowX}px` : \"\",\n                top: arrowY != null ? `${arrowY}px` : \"\",\n                right: \"\",\n                bottom: \"\",\n                [staticSide]: \"-4px\",\n              }}\n            />\n          </TooltipContent>\n        )}\n      </Transition>\n    </FloatingPortal>\n  );\n};\n\n// export { TooltipWrapper as Tooltip };\n\nexport type WithTooltipProps = {\n  children: JSX.Element;\n  tooltip: ReactNode;\n  placement?: Placement;\n};\n\nexport const WithTooltip: FC<WithTooltipProps> = forwardRef(\n  ({ children, tooltip, placement = \"top\", ...props }, forwardedRef) => {\n    const { getReferenceProps, refs, ...tt } = useTooltip(placement);\n\n    const ref = useMergeRefs([\n      refs.setReference,\n      forwardedRef,\n      (children as any).ref,\n    ]);\n\n    return (\n      <>\n        {cloneElement(\n          children,\n          getReferenceProps({ ref, ...children.props, ...props })\n        )}\n        <TooltipWrapper refs={refs} {...tt}>\n          {tooltip}\n        </TooltipWrapper>\n      </>\n    );\n  }\n);\n\nWithTooltip.displayName = \"WithTooltip\";\n"],"names":["_extends","TooltipContent","forwardRef","TooltipRefed","ref","className","children","props","React","div","useTooltip","placement","useState","show","setShow","arrowRef","useRef","fl","useFloating","middleware","offset","flip","shift","padding","left","right","arrow","element","open","onOpenChange","role","useRole","context","hover","useHover","delay","close","move","useInteractions","getReferenceProps","getFloatingProps","useMemo","TooltipWrapper","x","y","strategy","middlewareData","root","rootProvided","portalId","refs","arrowX","arrowY","floatingRef","staticSide","top","bottom","split","useFloatingContext","fallbackPortalId","id","useMergeRefs","setFloating","FloatingPortal","Transition","in","mountOnEnter","unmountOnExit","timeout","nodeRef","state","style","position","WithTooltip","forwardedRef","tooltip","tt","setReference","createElement","Fragment","cloneElement","displayName"],"mappings":"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"}