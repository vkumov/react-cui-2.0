{"version":3,"file":"index.js","sources":["../../src/SegmentedControl/SegmentedControl.tsx"],"sourcesContent":["import React, {\n  type FC,\n  type HTMLProps,\n  type PropsWithChildren,\n  type ReactNode,\n  type Ref,\n  useEffect,\n  useState,\n  forwardRef,\n  RefCallback,\n  useCallback,\n  MutableRefObject,\n} from \"react\";\nimport cx from \"classnames\";\n\nimport styles from \"./Segmented.module.scss\";\n\nexport type SegmentedOption<V> = {\n  label: ReactNode;\n  value: V;\n  disabled?: boolean;\n};\n\ntype ActiveProps = {\n  activeElement: HTMLDivElement | null;\n  value: any;\n  fullWidth?: boolean;\n  small: boolean;\n};\n\nconst Active: FC<ActiveProps> = ({\n  activeElement,\n  value,\n  fullWidth,\n  small,\n}) => {\n  const [coord, setCoord] = useState({ x: 0, y: 0, w: 0, h: 0 });\n\n  useEffect(() => {\n    if (!activeElement) return;\n\n    setCoord({\n      x: activeElement.offsetLeft - (small ? 2 : 4),\n      y: activeElement.offsetTop - (small ? 2 : 4),\n      w: activeElement.offsetWidth,\n      h: activeElement.offsetHeight,\n    });\n  }, [activeElement, value, fullWidth, small]);\n\n  if (!activeElement) return null;\n\n  return (\n    <span\n      className={styles.segmented_active}\n      style={{\n        width: `${coord.w}px`,\n        height: `${coord.h}px`,\n        transform:\n          coord.x > 0 || coord.y > 0\n            ? `translateX(${coord.x}px) translateY(${coord.y}px) translateZ(0px)`\n            : \"none\",\n      }}\n    />\n  );\n};\n\ntype OptionDisplayProps = {\n  value: any;\n  active: boolean;\n  disabled?: boolean;\n  activeRef: MutableRefObject<HTMLDivElement> | RefCallback<HTMLDivElement>;\n} & HTMLProps<HTMLInputElement>;\n\nconst OptionDisplay: FC<PropsWithChildren<OptionDisplayProps>> = ({\n  children,\n  value,\n  activeRef,\n  active,\n  className,\n  disabled,\n  id,\n  ...props\n}) => {\n  return (\n    <div\n      className={cx(styles.segmented_option_control, className, {\n        [styles.segmented_option_control_active]: active,\n        disabled,\n      })}\n      ref={active ? activeRef : null}\n    >\n      <input\n        type=\"radio\"\n        className={styles.segmented_option_control_input}\n        value={value}\n        id={`${id || props.name}-${value}`}\n        {...props}\n      />\n      <label\n        className={styles.segmented_option_control_label}\n        htmlFor={`${id || props.name}-${value}`}\n      >\n        {children}\n      </label>\n    </div>\n  );\n};\n\ntype Props<V> = {\n  options: SegmentedOption<V>[] | readonly SegmentedOption<V>[];\n  value: V;\n  label?: ReactNode;\n  inline?: boolean;\n  fullWidth?: boolean;\n  small?: boolean;\n} & HTMLProps<HTMLInputElement>;\n\nfunction UrefedSegmented<V extends string | number = string>(\n  {\n    options,\n    value,\n    label,\n    inline,\n    className,\n    fullWidth,\n    small,\n    ...props\n  }: Props<V>,\n  ref: Ref<HTMLDivElement>\n): JSX.Element {\n  const [el, setEl] = useState<HTMLDivElement | null>(null);\n  const activeRefCb: RefCallback<HTMLDivElement> = useCallback((node) => {\n    if (node !== null) {\n      setEl(node);\n    } else setEl(null);\n  }, []);\n\n  return (\n    <div\n      className={cx(\"form-group\", className, { \"form-group--inline\": inline })}\n    >\n      <div\n        className={cx(styles.form_group, {\n          [styles[\"form_group--full\"]]: fullWidth,\n          [styles.small]: small,\n        })}\n      >\n        {label ? <label>{label}</label> : null}\n        <div\n          className={cx(styles.segmented_root, {\n            [styles[\"segmented_root--full\"]]: fullWidth,\n          })}\n          ref={ref}\n        >\n          <Active\n            activeElement={el}\n            value={value}\n            fullWidth={fullWidth}\n            small={small}\n          />\n          {options.map((o) => (\n            <OptionDisplay\n              activeRef={activeRefCb}\n              active={value === o.value}\n              value={o.value}\n              key={o.value}\n              disabled={o.disabled}\n              {...props}\n            >\n              {o.label}\n            </OptionDisplay>\n          ))}\n        </div>\n      </div>\n    </div>\n  );\n}\n\nexport type SegmentedControlProps<V> = Props<V> & {\n  ref?: React.ForwardedRef<HTMLDivElement>;\n};\n\nexport const SegmentedControl = forwardRef(UrefedSegmented) as <\n  V extends string | number = string\n>({\n  options,\n  value,\n  ...props\n}: SegmentedControlProps<V>) => ReturnType<typeof UrefedSegmented>;\n"],"names":["Active","activeElement","value","fullWidth","small","coord","setCoord","useState","x","y","w","h","useEffect","offsetLeft","offsetTop","offsetWidth","offsetHeight","span","className","styles","segmented_active","style","width","height","transform","OptionDisplay","children","activeRef","active","disabled","id","props","div","cx","segmented_option_control","segmented_option_control_active","ref","input","type","segmented_option_control_input","name","label","segmented_option_control_label","htmlFor","UrefedSegmented","options","inline","el","setEl","activeRefCb","useCallback","node","form_group","segmented_root","map","o","key","SegmentedControl","forwardRef"],"mappings":"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"}