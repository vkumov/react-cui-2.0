{"version":3,"file":"index.js","sources":["../../src/Dropdown/Dropdown.tsx"],"sourcesContent":["import React, {\n  FC,\n  HTMLProps,\n  MouseEvent,\n  ReactNode,\n  useCallback,\n  useEffect,\n  useRef,\n  useState,\n} from \"react\";\n\nimport { ConditionalWrapper } from \"src/Conditional\";\nimport { appendClass } from \"src/utils\";\n\ntype ElementProps = {\n  selected?: boolean;\n  icon?: string;\n  children: ReactNode;\n} & HTMLProps<HTMLAnchorElement>;\n\nconst Element: FC<ElementProps> = ({\n  selected = false,\n  icon = null,\n  children,\n  className = null,\n  ...props\n}) => (\n  <a\n    className={`${selected ? \"selected\" : \"\"}${\n      className ? ` ${className}` : \"\"\n    }`}\n    {...props}\n  >\n    {icon ? <span className={`icon-${icon}`} /> : null}\n    <ConditionalWrapper\n      condition={Boolean(icon)}\n      wrapper={<span className=\"qtr-margin-left\" />}\n    >\n      {children}\n    </ConditionalWrapper>\n  </a>\n);\n\nconst Divider: FC = () => <div className=\"divider\" />;\n\ntype GroupProps = {\n  children: ReactNode;\n};\n\nconst Group: FC<GroupProps> = ({ children }) => (\n  <div className=\"dropdown__group\">{children}</div>\n);\n\ntype GroupHeaderProps = {\n  header: ReactNode;\n};\n\nconst GroupHeader: FC<GroupHeaderProps> = ({ header }) => (\n  <div className=\"dropdown__group-header\">{header}</div>\n);\n\ntype DropdownHeaderProps = {\n  type: string;\n  handleClick: (...args) => void;\n  className?: string;\n  header: ReactNode;\n};\n\nconst DropdownHeader: FC<DropdownHeaderProps> = ({\n  type,\n  handleClick,\n  className,\n  header,\n}) => {\n  switch (type) {\n    case \"icon\":\n      return <span onClick={handleClick} className={className} />;\n    case \"link\":\n      return (\n        <a onClick={handleClick} className={className}>\n          {header}\n        </a>\n      );\n    case \"div\":\n      return (\n        <div onClick={handleClick} className={className}>\n          {header}\n        </div>\n      );\n    case \"button\":\n      return (\n        <button\n          type=\"button\"\n          onClick={handleClick}\n          className={`btn ${className}`}\n        >\n          {header}\n        </button>\n      );\n    default:\n      return React.isValidElement(header)\n        ? React.cloneElement(header, { onClick: handleClick })\n        : null;\n  }\n};\n\ntype DropdownProps = {\n  type?: \"icon\" | \"link\" | \"div\" | \"button\" | \"custom\";\n  className?: string;\n  header?: ReactNode;\n  openTo?: \"left\" | \"right\" | \"center\";\n  alwaysClose?: boolean;\n  onOpen?: (e) => void;\n  onClose?: (e) => void;\n  stopPropagation?: boolean;\n  divClassName?: string;\n  children: ReactNode;\n  up?: boolean;\n  isOpen?: boolean;\n};\n\nexport interface DropdownParts {\n  Element: FC<ElementProps>;\n  Divider: FC;\n  Group: FC<GroupProps>;\n  GroupHeader: FC<GroupHeaderProps>;\n}\n\nconst Dropdown: DropdownParts & FC<DropdownProps> = ({\n  openTo = \"right\",\n  children,\n  type = \"button\",\n  className = null,\n  header = null,\n  divClassName = null,\n  up = false,\n  onClose = null,\n  onOpen = null,\n  stopPropagation = false,\n  alwaysClose = false,\n  isOpen: outsideIsOpen,\n}) => {\n  const [isOpen, setIsOpen] = useState(false);\n  const divRef = useRef<HTMLDivElement>(undefined);\n\n  useEffect(() => {\n    if (typeof outsideIsOpen !== \"undefined\" && outsideIsOpen !== null)\n      setIsOpen(outsideIsOpen);\n  }, [outsideIsOpen]);\n\n  // eslint-disable-next-line prefer-const\n  let handleOutsideClick;\n\n  const handleClick = useCallback(\n    (e): void => {\n      if (stopPropagation) {\n        e.stopPropagation();\n        e.preventDefault();\n      }\n\n      setIsOpen((current) => {\n        if (!current) {\n          // attach/remove event handler\n          document.addEventListener(\"click\", handleOutsideClick, true);\n        } else {\n          document.removeEventListener(\"click\", handleOutsideClick, true);\n        }\n        const newIsOpen = !current;\n        if (newIsOpen && onOpen) onOpen(e);\n        if (!newIsOpen && onClose) onClose(e);\n        return newIsOpen;\n      });\n    },\n    [stopPropagation, onClose, onOpen]\n  );\n\n  handleOutsideClick = (e: MouseEvent<Node>): void => {\n    // ignore clicks on the component itself\n    if (!(e.target instanceof Node) || !divRef?.current) return;\n    if (!alwaysClose && divRef.current && divRef.current.contains(e.target))\n      return;\n\n    if (!divRef.current.contains(e.target)) {\n      handleClick(e);\n      return;\n    }\n    if (!divRef.current.isSameNode(e.target.parentNode) && alwaysClose) {\n      handleClick(e);\n      return;\n    }\n  };\n\n  return (\n    <div\n      className={`dropdown${appendClass(\n        [\"left\", \"center\"].includes(openTo),\n        `dropdown--${openTo}`\n      )}${appendClass(up, \"dropdown--up\")}${appendClass(\n        isOpen,\n        \"active\"\n      )}${appendClass(divClassName)}`}\n      ref={divRef}\n    >\n      <DropdownHeader\n        type={type}\n        handleClick={handleClick}\n        className={className}\n        header={header}\n      />\n      <div className=\"dropdown__menu\">{children}</div>\n    </div>\n  );\n};\n\nDropdown.Divider = Divider;\nDropdown.Element = Element;\nDropdown.Group = Group;\nDropdown.GroupHeader = GroupHeader;\n\nexport {\n  Dropdown,\n  Element as DropdownElement,\n  Divider as DropdownDivider,\n  Group as DropdownGroup,\n  GroupHeader as DropdownGroupHeader,\n};\n"],"names":["Element","selected","icon","children","className","props","a","span","ConditionalWrapper","condition","Boolean","wrapper","Divider","div","Group","GroupHeader","header","DropdownHeader","type","handleClick","onClick","button","React","isValidElement","cloneElement","Dropdown","openTo","divClassName","up","onClose","onOpen","stopPropagation","alwaysClose","isOpen","outsideIsOpen","setIsOpen","useState","divRef","useRef","undefined","useEffect","handleOutsideClick","useCallback","e","preventDefault","current","document","addEventListener","removeEventListener","newIsOpen","target","Node","contains","isSameNode","parentNode","appendClass","includes","ref"],"mappings":"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"}