import e from"react";import t from"prop-types";import{b as r,a as l}from"../tslib.es6-633881f1.js";import{connect as a}from"formik";import o from"react-dropzone";
/*!
 * bytes
 * Copyright(c) 2012-2014 TJ Holowaychuk
 * Copyright(c) 2015 Jed Watson
 * MIT Licensed
 */var i=function(e,t){if("string"==typeof e)return f(e);if("number"==typeof e)return d(e,t);return null},n=d,s=f,p=/\B(?=(\d{3})+(?!\d))/g,m=/(?:\.0*|(\.[^0]+)0+)$/,c={b:1,kb:1024,mb:1<<20,gb:1<<30,tb:Math.pow(1024,4),pb:Math.pow(1024,5)},u=/^((-|\+)?(\d+(?:\.\d+)?)) *(kb|mb|gb|tb|pb)$/i;function d(e,t){if(!Number.isFinite(e))return null;var r=Math.abs(e),l=t&&t.thousandsSeparator||"",a=t&&t.unitSeparator||"",o=t&&void 0!==t.decimalPlaces?t.decimalPlaces:2,i=Boolean(t&&t.fixedDecimals),n=t&&t.unit||"";n&&c[n.toLowerCase()]||(n=r>=c.pb?"PB":r>=c.tb?"TB":r>=c.gb?"GB":r>=c.mb?"MB":r>=c.kb?"KB":"B");var s=(e/c[n.toLowerCase()]).toFixed(o);return i||(s=s.replace(m,"$1")),l&&(s=s.replace(p,l)),s+a+n}function f(e){if("number"==typeof e&&!isNaN(e))return e;if("string"!=typeof e)return null;var t,r=u.exec(e),l="b";return r?(t=parseFloat(r[1]),l=r[4].toLowerCase()):(t=parseInt(e,10),l="b"),Math.floor(c[l]*t)}i.format=n,i.parse=s;var h=function(t){var r=t.file,l=t.i,a=t.removeFile,o=t.inline;return e.createElement("div",{className:"file-drop__card col-lg-4 col-md-6 col-sm-6",key:l+"-"+r.name},e.createElement("div",{className:"panel panel--bordered hover-emboss--small",onClick:function(e){return e.stopPropagation()}},o?e.createElement("div",{className:"panel__body flex flex-row"},e.createElement("div",{className:"text-left flex-fill",style:{maxWidth:"calc(100% - 20px)"}},e.createElement("div",{className:"text-ellipsis"},r.name),e.createElement("small",{style:{whiteSpace:"nowrap"}},i.format(r.size,{unitSeparator:" "}))),e.createElement("a",{className:"link pull-right",onClick:function(){return a(l)}},e.createElement("span",{className:"icon-close",title:"Remove the file."}))):e.createElement("div",{className:"panel__body"},e.createElement("a",{className:"link pull-right",style:{marginRight:"5px"},onClick:function(){return a(l)}},e.createElement("span",{className:"icon-close",title:"Remove the file."})),e.createElement("div",{className:"text-ellipsis half-margin-bottom"},r.name),e.createElement("span",{className:"file-icon text-muted icon-file-o qtr-margin-right"}),e.createElement("small",null,i.format(r.size,{unitSeparator:" "})))))},v=a(function(a){function n(t){var r=a.call(this,t)||this;return r.removeFile=function(e){r.props.formik.setFieldValue(r.props.name,r.props.input.value.filter((function(t,r){return e!==r})))},r.handleDrop=function(e){r.maxFileSize&&(e=e.filter((function(e){return e.size<=r.maxFileSize}))),r.props.maxFiles&&e.length>r.props.maxFiles&&(e=e.slice(0,r.props.maxFiles)),r.props.formik.setFieldValue(r.props.name,e)},r.renderFiles=function(){var t=r.props.input.value;return t&&t.length&&Array.isArray(t)?e.createElement("div",{className:"dropzone-previews"},e.createElement("div",{className:"file-drop__container container--fluid"},e.createElement("div",{className:"row"},t.map((function(t,l){return e.createElement(h,{key:l,file:t,i:l,inline:r.props.inline,removeFile:r.removeFile})})))),r.props.showTotalSelected&&e.createElement("div",{className:"file-drop__filecnt"},t.length," selected")):null},r.renderMessage=function(){var t=r.props.input.value;return t&&t.length?null:r.props.inline?e.createElement("div",{className:"dropzone-message flex flex-row flex-center-vertical"},e.createElement("h5",{className:"text-muted text-left flex-fill no-margin"},"Click Here or Drop Files to Upload"),r.props.accept&&e.createElement("span",{className:"text-muted text-small half-margin-right"},"Allowed files: ",r.props.accept.split(",").join(", ")),e.createElement("span",{className:"file-drop__icon icon-upload"})):e.createElement("div",{className:"dropzone-message"},e.createElement("span",{className:"file-drop__icon icon-upload"}),e.createElement("h4",{className:"text-muted"},"Click Here or Drop Files to Upload"),r.props.accept&&e.createElement("div",{className:"text-muted"},"Allowed files: ",r.props.accept.split(",").join(", ")),r.maxFileSize&&e.createElement("div",{className:"text-muted"},"Max file size:"," ",i.format(r.maxFileSize,{unitSeparator:" "})))},t.maxFileSize?r.maxFileSize=i.parse(t.maxFileSize):r.maxFileSize=null,r}return r(n,a),n.prototype.render=function(){var t=this,r=this.props,a=r.meta,i=r.loose,n=r.compressed,s="";if(i&&(s="dropzone--loose"),n&&(s="dropzone--compressed"),this.props.inline&&this.props.input.value&&this.props.input.value.length)switch(s){case"dropzone--loose":s+=" half-padding-bottom";break;case"dropzone--compressed":s+=" no-padding-bottom";break;default:s+=" qtr-padding-bottom"}return e.createElement("div",{className:"form-group"+(a.touched&&a.error?" form-group--error":"")},e.createElement("div",{className:"form-group__text"},this.props.label?e.createElement("label",{htmlFor:this.props.name},this.props.label):null,e.createElement(o,{onDrop:this.handleDrop,maxSize:this.maxFileSize,multiple:this.props.multiple},(function(r){var a=r.getRootProps,o=r.getInputProps;return e.createElement("div",l({className:"dropzone "+s},a()),e.createElement("input",l({},o())),t.renderFiles(),t.renderMessage())}))),a.touched&&a.error&&e.createElement("div",{className:"help-block text-danger",role:"alert"},e.createElement("span",null,a.error)))},n.propTypes={label:t.string,accept:t.string,showTotalSelected:t.bool,maxFileSize:t.string,maxFiles:t.number,inline:t.bool,loose:t.bool,compressed:t.bool},n}(e.Component));export{v as Dropzone};
