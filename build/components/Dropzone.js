import e from"react";import t from"prop-types";import{a as l}from"../_rollupPluginBabelHelpers-b60338eb.js";import{connect as a}from"formik";import r from"react-dropzone";
/*!
 * bytes
 * Copyright(c) 2012-2014 TJ Holowaychuk
 * Copyright(c) 2015 Jed Watson
 * MIT Licensed
 */var s=function(e,t){if("string"==typeof e)return h(e);if("number"==typeof e)return d(e,t);return null},i=d,o=h,n=/\B(?=(\d{3})+(?!\d))/g,p=/(?:\.0*|(\.[^0]+)0+)$/,m={b:1,kb:1024,mb:1<<20,gb:1<<30,tb:Math.pow(1024,4),pb:Math.pow(1024,5)},c=/^((-|\+)?(\d+(?:\.\d+)?)) *(kb|mb|gb|tb|pb)$/i;function d(e,t){if(!Number.isFinite(e))return null;var l=Math.abs(e),a=t&&t.thousandsSeparator||"",r=t&&t.unitSeparator||"",s=t&&void 0!==t.decimalPlaces?t.decimalPlaces:2,i=Boolean(t&&t.fixedDecimals),o=t&&t.unit||"";o&&m[o.toLowerCase()]||(o=l>=m.pb?"PB":l>=m.tb?"TB":l>=m.gb?"GB":l>=m.mb?"MB":l>=m.kb?"KB":"B");var c=(e/m[o.toLowerCase()]).toFixed(s);return i||(c=c.replace(p,"$1")),a&&(c=c.replace(n,a)),c+r+o}function h(e){if("number"==typeof e&&!isNaN(e))return e;if("string"!=typeof e)return null;var t,l=c.exec(e),a="b";return l?(t=parseFloat(l[1]),a=l[4].toLowerCase()):(t=parseInt(e,10),a="b"),Math.floor(m[a]*t)}s.format=i,s.parse=o;const u=({file:t,i:l,removeFile:a,inline:r})=>e.createElement("div",{className:"file-drop__card col-lg-4 col-md-6 col-sm-6",key:`${l}-${t.name}`},e.createElement("div",{className:"panel panel--bordered hover-emboss--small",onClick:e=>e.stopPropagation()},r?e.createElement("div",{className:"panel__body flex flex-row"},e.createElement("div",{className:"text-left flex-fill",style:{maxWidth:"calc(100% - 20px)"}},e.createElement("div",{className:"text-ellipsis"},t.name),e.createElement("small",{style:{whiteSpace:"nowrap"}},s.format(t.size,{unitSeparator:" "}))),e.createElement("a",{className:"link pull-right",onClick:()=>a(l)},e.createElement("span",{className:"icon-close",title:"Remove the file."}))):e.createElement("div",{className:"panel__body"},e.createElement("a",{className:"link pull-right",style:{marginRight:"5px"},onClick:()=>a(l)},e.createElement("span",{className:"icon-close",title:"Remove the file."})),e.createElement("div",{className:"text-ellipsis half-margin-bottom"},t.name),e.createElement("span",{className:"file-icon text-muted icon-file-o qtr-margin-right"}),e.createElement("small",null,s.format(t.size,{unitSeparator:" "})))));class f extends e.Component{constructor(e){super(e),e.maxFileSize?this.maxFileSize=s.parse(e.maxFileSize):this.maxFileSize=null}removeFile(e){this.props.formik.setFieldValue(this.props.name,this.props.input.value.filter((t,l)=>e!==l))}handleDrop(e){this.maxFileSize&&(e=e.filter(e=>e.size<=this.maxFileSize)),this.props.maxFiles&&e.length>this.props.maxFiles&&(e=e.slice(0,this.props.maxFiles)),this.props.formik.setFieldValue(this.props.name,e)}renderFiles(){const t=this.props.input.value;return t&&t.length&&Array.isArray(t)?e.createElement("div",{className:"dropzone-previews"},e.createElement("div",{className:"file-drop__container container--fluid"},e.createElement("div",{className:"row"},t.map((t,l)=>e.createElement(u,{key:l,file:t,i:l,inline:this.props.inline,removeFile:this.removeFile})))),this.props.showTotalSelected&&e.createElement("div",{className:"file-drop__filecnt"},t.length," selected")):null}renderMessage(){const t=this.props.input.value;return t&&t.length?null:this.props.inline?e.createElement("div",{className:"dropzone-message flex flex-row flex-center-vertical"},e.createElement("h5",{className:"text-muted text-left flex-fill no-margin"},"Click Here or Drop Files to Upload"),this.props.accept&&e.createElement("span",{className:"text-muted text-small half-margin-right"},"Allowed files: ",this.props.accept.split(",").join(", ")),e.createElement("span",{className:"file-drop__icon icon-upload"})):e.createElement("div",{className:"dropzone-message"},e.createElement("span",{className:"file-drop__icon icon-upload"}),e.createElement("h4",{className:"text-muted"},"Click Here or Drop Files to Upload"),this.props.accept&&e.createElement("div",{className:"text-muted"},"Allowed files: ",this.props.accept.split(",").join(", ")),this.maxFileSize&&e.createElement("div",{className:"text-muted"},"Max file size:"," ",s.format(this.maxFileSize,{unitSeparator:" "})))}render(){const{meta:t,loose:a,compressed:s}=this.props;let i="";if(a&&(i="dropzone--loose"),s&&(i="dropzone--compressed"),this.props.inline&&this.props.input.value&&this.props.input.value.length)switch(i){case"dropzone--loose":i+=" half-padding-bottom";break;case"dropzone--compressed":i+=" no-padding-bottom";break;default:i+=" qtr-padding-bottom"}return e.createElement("div",{className:"form-group"+(t.touched&&t.error?" form-group--error":"")},e.createElement("div",{className:"form-group__text"},this.props.label?e.createElement("label",{htmlFor:this.props.name},this.props.label):null,e.createElement(r,{name:this.props.name,onDrop:this.handleDrop,maxSize:this.maxFileSize,multiple:this.props.multiple},({getRootProps:t,getInputProps:a})=>e.createElement("div",l({className:"dropzone "+i},t()),e.createElement("input",a()),this.renderFiles(),this.renderMessage()))),t.touched&&t.error&&e.createElement("div",{className:"help-block text-danger",role:"alert"},e.createElement("span",null,t.error)))}}f.propTypes={label:t.string,accept:t.string,showTotalSelected:t.bool,maxFileSize:t.string,maxFiles:t.number,inline:t.bool,loose:t.bool,compressed:t.bool};const b=a(f);export{b as Dropzone};
