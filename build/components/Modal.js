import e from"react";import t from"prop-types";import{_ as n,a as o}from"../_rollupPluginBabelHelpers-b60338eb.js";import{a as i,e as a,E as l}from"../index-be24eb93.js";import{s as r}from"../style-inject.es-1f59c1d0.js";import{Button as s}from"./Button.js";import"formik";import{DisplayIf as c,ConditionalWrapper as u}from"./Conditional.js";import"./InputHelpBlock.js";import{Input as p}from"./Input.js";import m from"react-dom";import d from"react-modal";var f=!1,E="production"!==process.env.NODE_ENV?t.oneOfType([t.number,t.shape({enter:t.number,exit:t.number,appear:t.number}).isRequired]):null,h=("production"!==process.env.NODE_ENV&&t.oneOfType([t.string,t.shape({enter:t.string,exit:t.string,active:t.string}),t.shape({enter:t.string,enterDone:t.string,enterActive:t.string,exit:t.string,exitDone:t.string,exitActive:t.string})]),e.createContext(null)),b=function(t){var n,o;function i(e,n){var o;o=t.call(this,e,n)||this;var i,a=n&&!n.isMounting?e.enter:e.appear;return o.appearStatus=null,e.in?a?(i="exited",o.appearStatus="entering"):i="entered":i=e.unmountOnExit||e.mountOnEnter?"unmounted":"exited",o.state={status:i},o.nextCallback=null,o}o=t,(n=i).prototype=Object.create(o.prototype),n.prototype.constructor=n,n.__proto__=o,i.getDerivedStateFromProps=function(e,t){return e.in&&"unmounted"===t.status?{status:"exited"}:null};var a=i.prototype;return a.componentDidMount=function(){this.updateStatus(!0,this.appearStatus)},a.componentDidUpdate=function(e){var t=null;if(e!==this.props){var n=this.state.status;this.props.in?"entering"!==n&&"entered"!==n&&(t="entering"):"entering"!==n&&"entered"!==n||(t="exiting")}this.updateStatus(!1,t)},a.componentWillUnmount=function(){this.cancelNextCallback()},a.getTimeouts=function(){var e,t,n,o=this.props.timeout;return e=t=n=o,null!=o&&"number"!=typeof o&&(e=o.exit,t=o.enter,n=void 0!==o.appear?o.appear:t),{exit:e,enter:t,appear:n}},a.updateStatus=function(e,t){if(void 0===e&&(e=!1),null!==t){this.cancelNextCallback();var n=m.findDOMNode(this);"entering"===t?this.performEnter(n,e):this.performExit(n)}else this.props.unmountOnExit&&"exited"===this.state.status&&this.setState({status:"unmounted"})},a.performEnter=function(e,t){var n=this,o=this.props.enter,i=this.context?this.context.isMounting:t,a=this.getTimeouts(),l=i?a.appear:a.enter;!t&&!o||f?this.safeSetState({status:"entered"},(function(){n.props.onEntered(e)})):(this.props.onEnter(e,i),this.safeSetState({status:"entering"},(function(){n.props.onEntering(e,i),n.onTransitionEnd(e,l,(function(){n.safeSetState({status:"entered"},(function(){n.props.onEntered(e,i)}))}))})))},a.performExit=function(e){var t=this,n=this.props.exit,o=this.getTimeouts();n&&!f?(this.props.onExit(e),this.safeSetState({status:"exiting"},(function(){t.props.onExiting(e),t.onTransitionEnd(e,o.exit,(function(){t.safeSetState({status:"exited"},(function(){t.props.onExited(e)}))}))}))):this.safeSetState({status:"exited"},(function(){t.props.onExited(e)}))},a.cancelNextCallback=function(){null!==this.nextCallback&&(this.nextCallback.cancel(),this.nextCallback=null)},a.safeSetState=function(e,t){t=this.setNextCallback(t),this.setState(e,t)},a.setNextCallback=function(e){var t=this,n=!0;return this.nextCallback=function(o){n&&(n=!1,t.nextCallback=null,e(o))},this.nextCallback.cancel=function(){n=!1},this.nextCallback},a.onTransitionEnd=function(e,t,n){this.setNextCallback(n);var o=null==t&&!this.props.addEndListener;e&&!o?(this.props.addEndListener&&this.props.addEndListener(e,this.nextCallback),null!=t&&setTimeout(this.nextCallback,t)):setTimeout(this.nextCallback,0)},a.render=function(){var t=this.state.status;if("unmounted"===t)return null;var n=this.props,o=n.children,i=function(e,t){if(null==e)return{};var n,o,i={},a=Object.keys(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||(i[n]=e[n]);return i}(n,["children"]);if(delete i.in,delete i.mountOnEnter,delete i.unmountOnExit,delete i.appear,delete i.enter,delete i.exit,delete i.timeout,delete i.addEndListener,delete i.onEnter,delete i.onEntering,delete i.onEntered,delete i.onExit,delete i.onExiting,delete i.onExited,"function"==typeof o)return e.createElement(h.Provider,{value:null},o(t,i));var a=e.Children.only(o);return e.createElement(h.Provider,{value:null},e.cloneElement(a,i))},i}(e.Component);function x(){}b.contextType=h,b.propTypes="production"!==process.env.NODE_ENV?{children:t.oneOfType([t.func.isRequired,t.element.isRequired]).isRequired,in:t.bool,mountOnEnter:t.bool,unmountOnExit:t.bool,appear:t.bool,enter:t.bool,exit:t.bool,timeout:function(e){var t=E;e.addEndListener||(t=t.isRequired);for(var n=arguments.length,o=new Array(n>1?n-1:0),i=1;i<n;i++)o[i-1]=arguments[i];return t.apply(void 0,[e].concat(o))},addEndListener:t.func,onEnter:t.func,onEntering:t.func,onEntered:t.func,onExit:t.func,onExiting:t.func,onExited:t.func}:{},b.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1,enter:!0,exit:!0,onEnter:x,onEntering:x,onEntered:x,onExit:x,onExiting:x,onExited:x},b.UNMOUNTED=0,b.EXITED=1,b.ENTERING=2,b.ENTERED=3,b.EXITING=4;r("@-webkit-keyframes fade-out{0%{opacity:1}to{opacity:0}}@keyframes fade-out{0%{opacity:1}to{opacity:0}}.cui .modal-backdrop{background:rgba(196,199,204,.65);pointer-events:all;opacity:1;transition:opacity .15s linear;outline:none}.cui .ReactModal__Overlay--before-close .modal__dialog{-webkit-animation:blowdown .3s cubic-bezier(.165,.84,.44,1) forwards,fade-out .25s linear 1!important;animation:blowdown .3s cubic-bezier(.165,.84,.44,1) forwards,fade-out .25s linear 1!important}.cui .ReactModal__Overlay--before-close{opacity:0!important}body.cui .modal .modal__content div.modal__close>a{color:var(--cui-inactive-color)}body.cui .modal .modal__content div.modal__close>a:hover{color:var(--cui-active-color);text-decoration:none}");const y=t=>{let{className:i,children:a}=t,l=n(t,["className","children"]);return e.createElement("div",o({className:"modal__header"+(i?" "+i:"")},l),a)};y.propTypes={className:t.string,children:t.node.isRequired},y.defaultProps={className:null};const g=t=>{let{className:i,children:a}=t,l=n(t,["className","children"]);return e.createElement("div",o({className:"modal__body"+(i?" "+i:"")},l),a)};g.propTypes={className:t.string,children:t.node.isRequired},g.defaultProps={className:null};const v=t=>{let{className:i,children:a}=t,l=n(t,["className","children"]);return e.createElement("div",o({className:"modal__footer"+(i?" "+i:"")},l),a)};v.propTypes={className:t.string,children:t.node.isRequired},v.defaultProps={className:null};const C=t=>{let{size:a,closeIcon:l,closeHandle:r,title:s,left:p,children:m,autoClose:f,isOpen:E,animationDuration:h,transitionEvents:x,dialogProps:g,contentProps:v,maximize:C}=t,O=n(t,["size","closeIcon","closeHandle","title","left","children","autoClose","isOpen","animationDuration","transitionEvents","dialogProps","contentProps","maximize"]);const[T,N]=e.useState(!1);e.useEffect(()=>N(!1),[E]);const _=e.useMemo(()=>T?"full":a,[T,a]),S=e.useCallback(()=>{N(e=>!e)},[]);return e.createElement(b,o({in:E,mountOnEnter:!0,unmountOnExit:!0,timeout:h},x),t=>e.createElement(d,o({},O,{autoClose:f,onRequestClose:f&&r?r:void 0,overlayClassName:"modal-backdrop",isOpen:["entering","entered"].includes(t),className:`modal${i(_,"modal--"+_)}${i(p,"modal--left")}`,closeTimeoutMS:"object"==typeof h?h.exiting:h}),e.createElement("div",o({className:"modal__dialog"},g,{onClick:e=>e.stopPropagation()}),e.createElement("div",o({className:"modal__content"},v),e.createElement(c,{condition:!(!l||!r)||C},e.createElement(u,{condition:!(!l||!r)&&C,wrapper:e.createElement("div",{className:"modal__close"})},e.createElement(c,{condition:C},e.createElement("a",{className:`${i(!(l&&r),"modal__close")}${i(l&&r,"qtr-margin-right")}`,onClick:S},e.createElement("span",{className:T?"icon-minimize":"icon-maximize"}))),e.createElement(c,{condition:!(!l||!r)},e.createElement("a",{className:C?"":"modal__close",onClick:r},e.createElement("span",{className:"icon-close"}))))),e.createElement(c,{condition:!!s},e.createElement(y,null,e.createElement("h1",{className:"modal__title"},s))),m))))};C.propTypes={size:t.oneOf([!1,"small","default","large","full","fluid"]),closeIcon:t.bool,closeHandle:t.func,title:t.string,isOpen:t.bool.isRequired,autoClose:t.bool,left:t.bool,animationDuration:t.oneOfType([t.number,t.shape({entering:t.number,exiting:t.number})]),children:t.node.isRequired,transitionEvents:t.objectOf(t.func),dialogProps:t.shape({}),contentProps:t.shape({}),maximize:t.bool},C.defaultProps={size:!1,autoClose:!0,animationDuration:250,closeIcon:!1,title:null,closeHandle:null,left:!1,transitionEvents:null,dialogProps:null,contentProps:null,maximize:!1},C.Small=t=>e.createElement(C,o({},t,{size:"small"})),C.Large=t=>e.createElement(C,o({},t,{size:"large"})),C.Full=t=>e.createElement(C,o({},t,{size:"full"})),C.Fluid=t=>e.createElement(C,o({},t,{size:"fluid"})),C.Header=y,C.Body=g,C.Footer=v;const O=({isOpen:t,confirmHandle:n,closeHandle:o,prompt:i,confirmType:a,confirmText:l,autoClose:r})=>{const[c,u]=e.useState(!1);return e.createElement(C,{isOpen:t,closeIcon:!0,closeHandle:o,autoClose:r,title:"Confirmation"},e.createElement(g,null,i),e.createElement(v,null,e.createElement(s.Light,{onClick:o},"Close"),e.createElement(s,{color:a,disabled:c,onClick:async()=>{u(!0),await n()&&u(!1)}},l,c?e.createElement("span",{className:"icon-animation spin qtr-margin-left"}):null)))};O.propTypes={isOpen:t.bool,confirmHandle:t.func.isRequired,closeHandle:t.func.isRequired,prompt:t.node.isRequired,confirmType:t.string,confirmText:t.string,autoClose:t.bool},O.defaultProps={isOpen:!1,confirmType:"primary",autoClose:!0,confirmText:"Confirm"};const T=({title:t,question:n,onSave:o,onClose:i,initial:a,type:l,isOpen:r,hint:u,validate:m})=>{const[d,f]=e.useState(a),E=e.useCallback(()=>{("function"!=typeof m||m(d))&&(i(),o(d))},[i,o,d,m]);return e.useLayoutEffect(()=>f(a),[a]),e.createElement(C,{isOpen:r,closeIcon:!0,closeHandle:i,title:t},e.createElement(g,null,e.createElement(p,{type:l,form:{errors:{},touched:{}},field:{onChange:e=>f(e.target.value),name:"promptInput",value:d},label:e.createElement(e.Fragment,null,n,e.createElement(c,{condition:!!u&&"string"==typeof u},e.createElement("span",{"data-balloon":u,"data-balloon-length":"large","data-balloon-pos":"up"},e.createElement("span",{className:"icon-question-circle qtr-margin-left",style:{cursor:"help"}}))))})),e.createElement(v,null,e.createElement(s,{color:"light",onClick:i},"Close"),e.createElement(s,{color:"primary",onClick:E},"OK")))};T.propTypes={title:t.node.isRequired,question:t.node.isRequired,onSave:t.func.isRequired,onClose:t.func,initial:t.oneOfType([t.string,t.number]),type:t.string,isOpen:t.bool.isRequired,hint:t.node,validate:t.func},T.defaultProps={onClose:null,initial:null,type:"text",hint:null,validate:null};const N=()=>{const[t,n]=e.useState(null),[o,i]=e.useState(!1);e.useEffect(()=>{a.on(l.SHOW_MODAL,e=>n(e))},[]),e.useEffect(()=>{t&&i(!0)},[t]);const r=()=>i(!1);if(!t)return null;if("notification"===t.modalType)return e.createElement(C,{isOpen:o,closeIcon:!0,closeHandle:r,title:t.title},e.createElement(g,null,t.body),e.createElement(v,null,e.createElement(s,{color:t.buttonColor||"light",onClick:r},t.button)));if("prompt"===t.modalType){if(void 0!==t.options){const{initial:n="",type:i="text",hint:a,validate:l}=t.options;return e.createElement(T,{isOpen:o,onClose:r,onSave:t.cb,title:t.title,question:t.question,initial:n,type:i,hint:a,validate:l})}return e.createElement(T,{isOpen:o,onClose:r,onSave:t.cb,title:t.title,question:t.question,initial:t.initial,type:t.type,hint:t.hint})}return"confirmation"===t.modalType?e.createElement(O,{isOpen:o,prompt:t.prompt,confirmHandle:async()=>(await t.onConfirm()&&r(),!0),closeHandle:r,confirmText:t.confirmText,confirmType:t.confirmType}):null},_=(t,n,o="primary",i="Confirm")=>{if(!t)throw new Error("Prompt must be specified");if(!n||"function"!=typeof n)throw new Error("onConfirm must be specified and must be a function");a.emit(l.SHOW_MODAL,{modalType:"confirmation",prompt:e.createElement("p",null,t),onConfirm:n,confirmText:i,confirmType:o})},S=(e,t,n="light",o="OK")=>{if(!e||!t)throw new Error("Title and body must be specified");a.emit(l.SHOW_MODAL,{modalType:"notification",title:e,body:t,buttonColor:n,button:o})},k=(e,t,n,o="",i="text",r)=>{if(!e||!t)throw new Error("Title and question must be specified");"object"!=typeof o?a.emit(l.SHOW_MODAL,{modalType:"prompt",title:e,initial:o,type:i,question:t,cb:n,hint:r}):a.emit(l.SHOW_MODAL,{modalType:"prompt",title:e,question:t,cb:n,options:o})};export{N as ConfirmationListener,O as ConfirmationModal,N as DynamicModal,C as Modal,g as ModalBody,v as ModalFooter,y as ModalHeader,T as PromptModal,_ as confirmation,S as notification,S as notificationModal,k as prompt};
