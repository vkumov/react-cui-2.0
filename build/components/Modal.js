import e from"react";import t from"prop-types";import{_ as n,a as o}from"../_rollupPluginBabelHelpers-b60338eb.js";import{a as i,e as a,E as l}from"../index-be24eb93.js";import{s as r}from"../style-inject.es-1f59c1d0.js";import{Button as s}from"./Button.js";import"formik";import{DisplayIf as c,ConditionalWrapper as u}from"./Conditional.js";import"./InputHelpBlock.js";import{Input as m}from"./Input.js";import{_ as p,a as d}from"../inheritsLoose-5aebf23c.js";import f from"react-dom";import E from"react-modal";var h=!1,b="production"!==process.env.NODE_ENV?t.oneOfType([t.number,t.shape({enter:t.number,exit:t.number,appear:t.number}).isRequired]):null,x=("production"!==process.env.NODE_ENV&&t.oneOfType([t.string,t.shape({enter:t.string,exit:t.string,active:t.string}),t.shape({enter:t.string,enterDone:t.string,enterActive:t.string,exit:t.string,exitDone:t.string,exitActive:t.string})]),e.createContext(null)),g=function(t){function n(e,n){var o;o=t.call(this,e,n)||this;var i,a=n&&!n.isMounting?e.enter:e.appear;return o.appearStatus=null,e.in?a?(i="exited",o.appearStatus="entering"):i="entered":i=e.unmountOnExit||e.mountOnEnter?"unmounted":"exited",o.state={status:i},o.nextCallback=null,o}p(n,t),n.getDerivedStateFromProps=function(e,t){return e.in&&"unmounted"===t.status?{status:"exited"}:null};var o=n.prototype;return o.componentDidMount=function(){this.updateStatus(!0,this.appearStatus)},o.componentDidUpdate=function(e){var t=null;if(e!==this.props){var n=this.state.status;this.props.in?"entering"!==n&&"entered"!==n&&(t="entering"):"entering"!==n&&"entered"!==n||(t="exiting")}this.updateStatus(!1,t)},o.componentWillUnmount=function(){this.cancelNextCallback()},o.getTimeouts=function(){var e,t,n,o=this.props.timeout;return e=t=n=o,null!=o&&"number"!=typeof o&&(e=o.exit,t=o.enter,n=void 0!==o.appear?o.appear:t),{exit:e,enter:t,appear:n}},o.updateStatus=function(e,t){if(void 0===e&&(e=!1),null!==t){this.cancelNextCallback();var n=f.findDOMNode(this);"entering"===t?this.performEnter(n,e):this.performExit(n)}else this.props.unmountOnExit&&"exited"===this.state.status&&this.setState({status:"unmounted"})},o.performEnter=function(e,t){var n=this,o=this.props.enter,i=this.context?this.context.isMounting:t,a=this.getTimeouts(),l=i?a.appear:a.enter;!t&&!o||h?this.safeSetState({status:"entered"},(function(){n.props.onEntered(e)})):(this.props.onEnter(e,i),this.safeSetState({status:"entering"},(function(){n.props.onEntering(e,i),n.onTransitionEnd(e,l,(function(){n.safeSetState({status:"entered"},(function(){n.props.onEntered(e,i)}))}))})))},o.performExit=function(e){var t=this,n=this.props.exit,o=this.getTimeouts();n&&!h?(this.props.onExit(e),this.safeSetState({status:"exiting"},(function(){t.props.onExiting(e),t.onTransitionEnd(e,o.exit,(function(){t.safeSetState({status:"exited"},(function(){t.props.onExited(e)}))}))}))):this.safeSetState({status:"exited"},(function(){t.props.onExited(e)}))},o.cancelNextCallback=function(){null!==this.nextCallback&&(this.nextCallback.cancel(),this.nextCallback=null)},o.safeSetState=function(e,t){t=this.setNextCallback(t),this.setState(e,t)},o.setNextCallback=function(e){var t=this,n=!0;return this.nextCallback=function(o){n&&(n=!1,t.nextCallback=null,e(o))},this.nextCallback.cancel=function(){n=!1},this.nextCallback},o.onTransitionEnd=function(e,t,n){this.setNextCallback(n);var o=null==t&&!this.props.addEndListener;e&&!o?(this.props.addEndListener&&this.props.addEndListener(e,this.nextCallback),null!=t&&setTimeout(this.nextCallback,t)):setTimeout(this.nextCallback,0)},o.render=function(){var t=this.state.status;if("unmounted"===t)return null;var n=this.props,o=n.children,i=d(n,["children"]);if(delete i.in,delete i.mountOnEnter,delete i.unmountOnExit,delete i.appear,delete i.enter,delete i.exit,delete i.timeout,delete i.addEndListener,delete i.onEnter,delete i.onEntering,delete i.onEntered,delete i.onExit,delete i.onExiting,delete i.onExited,"function"==typeof o)return e.createElement(x.Provider,{value:null},o(t,i));var a=e.Children.only(o);return e.createElement(x.Provider,{value:null},e.cloneElement(a,i))},n}(e.Component);function y(){}g.contextType=x,g.propTypes="production"!==process.env.NODE_ENV?{children:t.oneOfType([t.func.isRequired,t.element.isRequired]).isRequired,in:t.bool,mountOnEnter:t.bool,unmountOnExit:t.bool,appear:t.bool,enter:t.bool,exit:t.bool,timeout:function(e){var t=b;e.addEndListener||(t=t.isRequired);for(var n=arguments.length,o=new Array(n>1?n-1:0),i=1;i<n;i++)o[i-1]=arguments[i];return t.apply(void 0,[e].concat(o))},addEndListener:t.func,onEnter:t.func,onEntering:t.func,onEntered:t.func,onExit:t.func,onExiting:t.func,onExited:t.func}:{},g.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1,enter:!0,exit:!0,onEnter:y,onEntering:y,onEntered:y,onExit:y,onExiting:y,onExited:y},g.UNMOUNTED=0,g.EXITED=1,g.ENTERING=2,g.ENTERED=3,g.EXITING=4;r("@-webkit-keyframes fade-out{0%{opacity:1}to{opacity:0}}@keyframes fade-out{0%{opacity:1}to{opacity:0}}.cui .modal-backdrop{background:rgba(196,199,204,.65);pointer-events:all;opacity:1;transition:opacity .15s linear;outline:none}.cui .ReactModal__Overlay--before-close .modal__dialog{-webkit-animation:blowdown .3s cubic-bezier(.165,.84,.44,1) forwards,fade-out .25s linear 1!important;animation:blowdown .3s cubic-bezier(.165,.84,.44,1) forwards,fade-out .25s linear 1!important}.cui .ReactModal__Overlay--before-close{opacity:0!important}body.cui .modal .modal__content div.modal__close>a{color:var(--cui-inactive-color)}body.cui .modal .modal__content div.modal__close>a:hover{color:var(--cui-active-color);text-decoration:none}");const v=t=>{let{className:i,children:a}=t,l=n(t,["className","children"]);return e.createElement("div",o({className:"modal__header"+(i?" "+i:"")},l),a)};v.propTypes={className:t.string,children:t.node.isRequired},v.defaultProps={className:null};const C=t=>{let{className:i,children:a}=t,l=n(t,["className","children"]);return e.createElement("div",o({className:"modal__body"+(i?" "+i:"")},l),a)};C.propTypes={className:t.string,children:t.node.isRequired},C.defaultProps={className:null};const O=t=>{let{className:i,children:a}=t,l=n(t,["className","children"]);return e.createElement("div",o({className:"modal__footer"+(i?" "+i:"")},l),a)};O.propTypes={className:t.string,children:t.node.isRequired},O.defaultProps={className:null};const T=t=>{let{size:a,closeIcon:l,closeHandle:r,title:s,left:m,children:p,autoClose:d,isOpen:f,animationDuration:h,transitionEvents:b,dialogProps:x,contentProps:y,maximize:C}=t,O=n(t,["size","closeIcon","closeHandle","title","left","children","autoClose","isOpen","animationDuration","transitionEvents","dialogProps","contentProps","maximize"]);const[T,N]=e.useState(!1);e.useEffect(()=>N(!1),[f]);const _=e.useMemo(()=>T?"full":a,[T,a]),S=e.useCallback(()=>{N(e=>!e)},[]);return e.createElement(g,o({in:f,mountOnEnter:!0,unmountOnExit:!0,timeout:h},b),t=>e.createElement(E,o({},O,{autoClose:d,onRequestClose:d&&r?r:void 0,overlayClassName:"modal-backdrop",isOpen:["entering","entered"].includes(t),className:`modal${i(_,"modal--"+_)}${i(m,"modal--left")}`,closeTimeoutMS:"object"==typeof h?h.exiting:h}),e.createElement("div",o({className:"modal__dialog"},x,{onClick:e=>e.stopPropagation()}),e.createElement("div",o({className:"modal__content"},y),e.createElement(c,{condition:!(!l||!r)||C},e.createElement(u,{condition:!(!l||!r)&&C,wrapper:e.createElement("div",{className:"modal__close"})},e.createElement(c,{condition:C},e.createElement("a",{className:`${i(!(l&&r),"modal__close")}${i(l&&r,"qtr-margin-right")}`,onClick:S},e.createElement("span",{className:T?"icon-minimize":"icon-maximize"}))),e.createElement(c,{condition:!(!l||!r)},e.createElement("a",{className:C?"":"modal__close",onClick:r},e.createElement("span",{className:"icon-close"}))))),e.createElement(c,{condition:!!s},e.createElement(v,null,e.createElement("h1",{className:"modal__title"},s))),p))))};T.propTypes={size:t.oneOf([!1,"small","default","large","full","fluid"]),closeIcon:t.bool,closeHandle:t.func,title:t.string,isOpen:t.bool.isRequired,autoClose:t.bool,left:t.bool,animationDuration:t.oneOfType([t.number,t.shape({entering:t.number,exiting:t.number})]),children:t.node.isRequired,transitionEvents:t.objectOf(t.func),dialogProps:t.shape({}),contentProps:t.shape({}),maximize:t.bool},T.defaultProps={size:!1,autoClose:!0,animationDuration:250,closeIcon:!1,title:null,closeHandle:null,left:!1,transitionEvents:null,dialogProps:null,contentProps:null,maximize:!1},T.Small=t=>e.createElement(T,o({},t,{size:"small"})),T.Large=t=>e.createElement(T,o({},t,{size:"large"})),T.Full=t=>e.createElement(T,o({},t,{size:"full"})),T.Fluid=t=>e.createElement(T,o({},t,{size:"fluid"})),T.Header=v,T.Body=C,T.Footer=O;const N=({isOpen:t,confirmHandle:n,closeHandle:o,prompt:i,confirmType:a,confirmText:l,autoClose:r})=>{const[c,u]=e.useState(!1);return e.createElement(T,{isOpen:t,closeIcon:!0,closeHandle:o,autoClose:r,title:"Confirmation"},e.createElement(C,null,e.createElement("p",null,i)),e.createElement(O,null,e.createElement(s.Light,{onClick:o},"Close"),e.createElement(s,{color:a,disabled:c,onClick:async()=>{u(!0),await n()&&u(!1)}},l,c?e.createElement("span",{className:"icon-animation spin qtr-margin-left"}):null)))};N.propTypes={isOpen:t.bool,confirmHandle:t.func.isRequired,closeHandle:t.func.isRequired,prompt:t.node.isRequired,confirmType:t.string,confirmText:t.string,autoClose:t.bool},N.defaultProps={isOpen:!1,confirmType:"primary",autoClose:!0,confirmText:"Confirm"};const _=({title:t,question:n,onSave:o,onClose:i,initial:a,type:l,isOpen:r,hint:u})=>{const[p,d]=e.useState(a),f=e.useCallback(()=>{i(),o(p)},[i,o,p]);return e.useLayoutEffect(()=>d(a),[a]),e.createElement(T,{isOpen:r,closeIcon:!0,closeHandle:i,title:t},e.createElement(C,null,e.createElement(m,{type:l,form:{errors:{},touched:{}},field:{onChange:e=>d(e.target.value),name:"promptInput",value:p},label:e.createElement(e.Fragment,null,n,e.createElement(c,{condition:!!u&&"string"==typeof u},e.createElement("span",{"data-balloon":u,"data-balloon-length":"large","data-balloon-pos":"up"},e.createElement("span",{className:"icon-question-circle qtr-margin-left",style:{cursor:"help"}}))))})),e.createElement(O,null,e.createElement(s,{color:"light",onClick:i},"Close"),e.createElement(s,{color:"primary",onClick:f},"OK")))};_.propTypes={title:t.node.isRequired,question:t.node.isRequired,onSave:t.func.isRequired,onClose:t.func,initial:t.oneOfType([t.string,t.number]),type:t.string,isOpen:t.bool.isRequired,hint:t.node},_.defaultProps={onClose:null,initial:null,type:"text",hint:null};const S=()=>{const[t,n]=e.useState(null),[o,i]=e.useState(!1);e.useEffect(()=>{a.on(l.SHOW_MODAL,e=>n(e))},[]),e.useEffect(()=>{t&&i(!0)},[t]);const r=()=>i(!1);return t?"notification"===t.modalType?e.createElement(T,{isOpen:o,closeIcon:!0,closeHandle:r,title:t.title},e.createElement(C,null,t.body),e.createElement(O,null,e.createElement(s,{color:t.buttonColor||"light",onClick:r},t.button))):"prompt"===t.modalType?e.createElement(_,{isOpen:o,onClose:r,onSave:t.cb,title:t.title,question:t.question,initial:t.initial,type:t.type,hint:t.hint}):"confirmation"===t.modalType?e.createElement(N,{isOpen:o,prompt:t.prompt,confirmHandle:async()=>(await t.onConfirm()&&r(),!0),closeHandle:r,confirmText:t.confirmText,confirmType:t.confirmType}):null:null},k=(e,t,n="primary",o="Confirm")=>{if(!e)throw new Error("Prompt must be specified");if(!t||"function"!=typeof t)throw new Error("onConfirm must be specified and must be a function");a.emit(l.SHOW_MODAL,{modalType:"confirmation",prompt:e,onConfirm:t,confirmText:o,confirmType:n})},q=(e,t,n="light",o="OK")=>{if(!e||!t)throw new Error("Title and body must be specified");a.emit(l.SHOW_MODAL,{modalType:"notification",title:e,body:t,buttonColor:n,button:o})},R=(e,t,n,o="",i="text",r)=>{if(!e||!t)throw new Error("Title and question must be specified");a.emit(l.SHOW_MODAL,{modalType:"prompt",title:e,initial:o,type:i,question:t,cb:n,hint:r})};export{S as ConfirmationListener,N as ConfirmationModal,S as DynamicModal,T as Modal,C as ModalBody,O as ModalFooter,v as ModalHeader,_ as PromptModal,k as confirmation,q as notification,q as notificationModal,R as prompt};
