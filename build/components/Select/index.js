import{_ as e,a as t}from"../../tslib.es6-4bca28b2.js";import r,{useEffect as n,useLayoutEffect as o}from"react";import{InputChips as l}from"../InputChips/index.js";import{InputHelpBlock as i}from"../InputHelpBlock.js";import{a}from"../../index-59462297.js";import"../Conditional.js";import"../Label/index.js";import"../InputHelpBaloon.js";import"../../style-inject.es-1f59c1d0.js";var c=function(e){var t=e.children,n=e.handleOptionClick,o=e.isSelected;return r.Children.map(t,(function(e,t){switch(e.type){case"option":return r.createElement("a",{key:t,onClick:function(t){return n(t,e.props.value)},className:""+a(o(e.props.value),"selected")+a(e.props.disabled,"disabled")},e.props.children);case"optgroup":return r.createElement("div",{key:t,className:"dropdown__group"},r.createElement("div",{className:"dropdown__group-header"},e.props.label),r.createElement(c,{handleOptionClick:n,isSelected:o},e.props.children));default:return e}}))},d=r.forwardRef((function(d,u){var s=d.compressed,p=void 0!==s&&s,m=d.prompt,f=void 0===m?"Select an option":m,v=d.inline,h=void 0!==v&&v,b=d.type,y=void 0===b?"text":b,E=d.children,g=d.label,C=void 0===g?null:g,k=d.error,j=void 0===k?null:k,_=d.onChange,w=void 0===_?null:_,x=d.value,N=void 0===x?void 0:x,S=d.editable,O=void 0!==S&&S,A=d.multi,I=void 0!==A&&A;d.ref;var L,B=e(d,["compressed","prompt","inline","type","children","label","error","onChange","value","editable","multi","ref"]),H=r.useState(!1),F=H[0],R=H[1],V=r.useState(void 0),W=V[0],q=V[1],z=r.useState(N),D=z[0],G=z[1],J=function(e){void 0===e&&(e=!0),e&&!F?document.addEventListener("click",L,!1):document.removeEventListener("click",L,!1),R(e)};L=function(e){var t=u||W;t&&t.contains(e.target)||J(!1)};return n((function(){G(N)}),[N]),o((function(){if(I&&N&&!Array.isArray(N))throw Error("Value must be an array if multi select is allowed.")}),[I,N]),n((function(){"function"==typeof w&&w(D)}),[D]),r.createElement("div",{className:"form-group dropdown"+a(p,"input--compressed")+a(F,"active")+a(h,"form-group--inline")+a(j,"form-group--error"),ref:u||function(e){return q(e)}},I?r.createElement(l,t({className:"select editable",label:C},B,{placeholder:Array.isArray(D)&&D.length?"":f||B.placeholder,readOnly:!O,onClick:function(){return J(!0)},onChange:function(e){return G(e)},value:D,outerWrap:!1})):r.createElement("div",{className:"form-group__text select editable",onClick:function(){return J(!0)}},r.createElement("input",t({type:y,placeholder:f||B.placeholder,autoComplete:"off",readOnly:!O},B,{onChange:function(e){O&&(e.persist(),G(e.target.value))},value:D})),C?r.createElement("label",{htmlFor:B.id},C):null),r.createElement("div",{className:"dropdown__menu"},r.createElement(c,{handleOptionClick:function(e,t){G(I?function(e){return(null==e?void 0:e.includes(t))?e.filter((function(e){return e!==t})):(e||[]).concat(t)}:t),I||J(!1)},isSelected:function(e){return I?null==D?void 0:D.includes(e):D===e}},E)),j?r.createElement(i,{text:j}):null)}));export{d as EditableSelect};
