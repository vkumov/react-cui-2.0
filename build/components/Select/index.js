import{_ as e,a as n}from"../../tslib.es6-4bca28b2.js";import r,{useState as t,forwardRef as l,useRef as o,useMemo as i,useCallback as a,useEffect as c,useLayoutEffect as u,isValidElement as d}from"react";import{InputChips as s}from"../InputChips/index.js";import{InputHelpBlock as p}from"../InputHelpBlock.js";import{a as f}from"../../index-59462297.js";import"../Conditional.js";import"../Label/index.js";import"../InputHelpBaloon.js";import"../../style-inject.es-1f59c1d0.js";function m(e,n){return r=n,l=function(n){return e.forEach((function(e){return function(e,n){return"function"==typeof e?e(n):e&&(e.current=n),e}(e,n)}))},(o=t((function(){return{value:r,callback:l,facade:{get current(){return o.value},set current(e){var n=o.value;n!==e&&(o.value=e,o.callback(e,n))}}}}))[0]).callback=l,o.facade;var r,l,o}function v(e){return"option"===e.type}function h(e){return"optgroup"===e.type}var b=function(e){var n=e.children,t=e.handleOptionClick,l=e.isSelected;return r.Children.map(n,(function(e,n){return d(e)?v(e)?r.createElement("a",{key:n,onClick:function(n){return t(n,e.props.value)},className:""+f(l(e.props.value),"selected")+f(e.props.disabled,"disabled")},e.props.children):h(e)?r.createElement("div",{key:n,className:"dropdown__group"},r.createElement("div",{className:"dropdown__group-header"},e.props.label),r.createElement(b,{handleOptionClick:t,isSelected:l},e.props.children)):e:e}))},y=function(e){var n=[];return r.Children.forEach(e,(function(e){if(!d(e))return null;v(e)&&n.push({display:e.props.children,value:e.props.value}),h(e)&&n.push(y(e.props.children))})),n.flat()},g=l((function(l,d){var v,h=l.compressed,g=void 0!==h&&h,E=l.prompt,C=void 0===E?"Select an option":E,k=l.inline,N=void 0!==k&&k,j=l.type,_=void 0===j?"text":j,x=l.children,w=l.label,O=void 0===w?null:w,A=l.error,S=void 0===A?null:A,I=l.onChange,L=void 0===I?null:I,V=l.value,B=void 0===V?void 0:V,H=l.editable,F=void 0!==H&&H,W=l.multi,q=void 0!==W&&W;l.ref;var z,D=l.displayValues,G=void 0!==D&&D,J=l.disabled,K=l.className,M=e(l,["compressed","prompt","inline","type","children","label","error","onChange","value","editable","multi","ref","displayValues","disabled","className"]),P=t(!1),Q=P[0],R=P[1],T=t(B),U=T[0],X=T[1],Y=o(void 0),Z=i((function(){return y(x)}),[x]),$=a((function(e){void 0===e&&(e=!0),J||R((function(n){return e&&!n?document.addEventListener("click",z,!0):document.removeEventListener("click",z,!0),e}))}),[J]);z=function(e){e.target instanceof Node&&(null==Y?void 0:Y.current)&&(Y.current&&Y.current.contains(e.target)||!Y.current||Y.current.contains(e.target)||$(!1))};return c((function(){X(B)}),[B]),u((function(){if(q&&B&&!Array.isArray(B))throw Error("Value must be an array if multi select is allowed.")}),[q,B]),c((function(){"function"==typeof L&&L(U)}),[U]),r.createElement("div",{className:"form-group dropdown"+f(g,"input--compressed")+f(Q,"active")+f(N,"form-group--inline")+f(S,"form-group--error")+f(J,"disabled")+f(K),ref:m([Y,d])},q?r.createElement(s,n({className:"select editable",label:O},M,{placeholder:Array.isArray(U)&&U.length?"":C||M.placeholder,readOnly:!F,onClick:function(){return $(!0)},onChange:function(e){return X(e)},value:U,outerWrap:!1})):r.createElement("div",{className:"form-group__text select editable",onClick:function(){return $(!0)}},r.createElement("input",n({type:_,placeholder:C||M.placeholder,autoComplete:"off",readOnly:!F},M,{onChange:function(e){F&&(e.persist(),X(e.target.value))},value:F?U||"":G?U:(null===(v=null==Z?void 0:Z.find((function(e){return e.value===U})))||void 0===v?void 0:v.display)||""})),O?r.createElement("label",{htmlFor:M.id},O):null),r.createElement("div",{className:"dropdown__menu"},r.createElement(b,{handleOptionClick:function(e,n){X(q?function(e){return(null==e?void 0:e.includes(n))?e.filter((function(e){return e!==n})):(e||[]).concat(n)}:n),q||$(!1)},isSelected:function(e){return q?null==U?void 0:U.includes(e):U===e}},x)),S?r.createElement(p,{text:S}):null)}));export{g as EditableSelect};
