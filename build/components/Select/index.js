import{_ as e,a as n}from"../../tslib.es6-4bca28b2.js";import r,{useState as t,forwardRef as l,useRef as o,useMemo as i,useCallback as a,useEffect as c,useLayoutEffect as u,isValidElement as d}from"react";import{InputChips as s}from"../InputChips/index.js";import{InputHelpBlock as p}from"../InputHelpBlock.js";import{a as f}from"../../index-59462297.js";import"../Conditional.js";import"../Label/index.js";import"../InputHelpBaloon.js";import"../../style-inject.es-1f59c1d0.js";function m(e,n){return r=n,l=function(n){return e.forEach((function(e){return function(e,n){return"function"==typeof e?e(n):e&&(e.current=n),e}(e,n)}))},(o=t((function(){return{value:r,callback:l,facade:{get current(){return o.value},set current(e){var n=o.value;n!==e&&(o.value=e,o.callback(e,n))}}}}))[0]).callback=l,o.facade;var r,l,o}function v(e){return"option"===e.type}function h(e){return"optgroup"===e.type}var b=function(e){var n=e.children,t=e.handleOptionClick,l=e.isSelected;return r.Children.map(n,(function(e,n){return d(e)?v(e)?r.createElement("a",{key:n,onClick:function(n){return t(n,e.props.value)},className:""+f(l(e.props.value),"selected")+f(e.props.disabled,"disabled")},e.props.children):h(e)?r.createElement("div",{key:n,className:"dropdown__group"},r.createElement("div",{className:"dropdown__group-header"},e.props.label),r.createElement(b,{handleOptionClick:t,isSelected:l},e.props.children)):e:e}))},y=function(e){var n=[];return r.Children.forEach(e,(function(e){if(!d(e))return null;v(e)&&n.push({display:e.props.children,value:e.props.value}),h(e)&&n.push(y(e.props.children))})),n.flat()},g=l((function(l,d){var v,h,g=l.compressed,E=void 0!==g&&g,C=l.prompt,k=void 0===C?"Select an option":C,N=l.inline,j=void 0!==N&&N,_=l.type,x=void 0===_?"text":_,w=l.children,O=l.label,A=void 0===O?null:O,S=l.error,I=void 0===S?null:S,L=l.onChange,V=void 0===L?null:L,B=l.value,H=void 0===B?void 0:B,R=l.editable,F=void 0!==R&&R,W=l.multi,q=void 0!==W&&W,z=l.displayValues,D=void 0!==z&&z,G=l.disabled,J=l.className,K=l.divRef,M=e(l,["compressed","prompt","inline","type","children","label","error","onChange","value","editable","multi","displayValues","disabled","className","divRef"]),P=t(!1),Q=P[0],T=P[1],U=t(H),X=U[0],Y=U[1],Z=o(void 0),$=i((function(){return y(w)}),[w]),ee=a((function(e){void 0===e&&(e=!0),G||T((function(n){return e&&!n?document.addEventListener("click",h,!0):document.removeEventListener("click",h,!0),e}))}),[G]);h=function(e){e.target instanceof Node&&(null==Z?void 0:Z.current)&&(Z.current&&Z.current.contains(e.target)||!Z.current||Z.current.contains(e.target)||ee(!1))};return c((function(){Y(H)}),[H]),u((function(){if(q&&H&&!Array.isArray(H))throw Error("Value must be an array if multi select is allowed.")}),[q,H]),c((function(){"function"==typeof V&&V(X)}),[X]),r.createElement("div",{className:"form-group dropdown"+f(E,"input--compressed")+f(Q,"active")+f(j,"form-group--inline")+f(I,"form-group--error")+f(G,"disabled")+f(J),ref:m([Z,K])},q?r.createElement(s,n({className:"select editable",label:A},M,{placeholder:Array.isArray(X)&&X.length?"":k||M.placeholder,readOnly:!F,onClick:function(){return ee(!0)},onChange:function(e){return Y(e)},value:X,outerWrap:!1,ref:d})):r.createElement("div",{className:"form-group__text select editable",onClick:function(){return ee(!0)}},r.createElement("input",n({type:x,placeholder:k||M.placeholder,autoComplete:"off",readOnly:!F},M,{onChange:function(e){F&&(e.persist(),Y(e.target.value))},value:F?X||"":D?X:(null===(v=null==$?void 0:$.find((function(e){return e.value===X})))||void 0===v?void 0:v.display)||"",ref:d})),A?r.createElement("label",{htmlFor:M.id},A):null),r.createElement("div",{className:"dropdown__menu"},r.createElement(b,{handleOptionClick:function(e,n){Y(q?function(e){return(null==e?void 0:e.includes(n))?e.filter((function(e){return e!==n})):(e||[]).concat(n)}:n),q||ee(!1)},isSelected:function(e){return q?null==X?void 0:X.includes(e):X===e}},w)),I?r.createElement(p,{text:I}):null)}));export{g as EditableSelect};
