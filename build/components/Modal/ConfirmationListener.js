import{d as n,a as o,b as t,c as e}from"../../tslib.es6-a57c95d4.js";import i,{cloneElement as r}from"react";import{Button as l}from"../Button/index.js";import{e as a}from"../../eventManager-f62d060d.js";import{ModalBody as u}from"./Body.js";import{ModalFooter as c}from"./Footer.js";import{Modal as d}from"./Modal.js";import{ConfirmationModal as s}from"./ConfirmationModal.js";import{PromptModal as f}from"./PromptModal.js";import"../../index-af0cb17c.js";import"../../style-inject.es-1f59c1d0.js";import"react-dom";import"react-modal";import"../Conditional.js";import"./Header.js";import"../Input/index.js";import"../InputHelpBlock.js";var m=function(){var m=i.useState([]),p=m[0],y=m[1],C=i.useCallback((function(t){return y((function(e){return n(n([],e,!0),[o({id:Date.now(),shown:!0},t)],!1)}))}),[]),v=i.useCallback((function(n){y((function(t){return t.map((function(t){return t.id===n?o(o({},t),{shown:!1}):t}))}))}),[]),h=i.useCallback((function(n){y((function(o){return o.filter((function(o){return o.id===n&&"function"==typeof o.onClosed&&o.onClosed(),o.id!==n}))}))}),[]),M=i.useCallback((function(n,o){v(n),setTimeout((function(){return h(n)}),500),o&&o()}),[v,h]);return i.useEffect((function(){var n=function(n){return C(n)};return a.on("showModal",n),function(){a.off("showModal",n)}}),[C]),p.length?i.createElement(i.Fragment,null,p.map((function(n){if("dynamic"===n.modalType)return i.createElement(d,o({},n.modalProps,{key:n.id,isOpen:n.shown,closeHandle:function(){return M(n.id,n.onModalClose)},title:n.title}),n.fullBody?"function"==typeof n.fullBody?n.fullBody({close:function(){return M(n.id,n.onModalClose)}}):r(n.fullBody,{close:function(){return M(n.id,n.onModalClose)}}):i.createElement(i.Fragment,null,i.createElement(u,null,n.body),i.createElement(c,null,n.buttons.map((function(o,t){return i.createElement(l,{key:t,color:o.color||"light",onClick:function(t){"function"==typeof o.onClick?o.onClick(t,(function(){return M(n.id,n.onModalClose)})):M(n.id,n.onModalClose)}},o.text)})))));if("notification"===n.modalType)return i.createElement(d,{key:n.id,isOpen:n.shown,closeIcon:!0,closeHandle:function(){return M(n.id,n.onModalClose)},title:n.title},i.createElement(u,null,n.body),i.createElement(c,null,i.createElement(l,{color:n.buttonColor||"light",onClick:function(){return M(n.id,n.onModalClose)}},n.button)));if("prompt"===n.modalType){if(void 0!==n.options){var a=n.options,m=a.initial,p=void 0===m?"":m,y=a.type,C=void 0===y?"text":y,v=a.hint,h=void 0===v?void 0:v,k=a.validate,b=void 0===k?void 0:k;return i.createElement(f,{key:n.id,isOpen:n.shown,onClose:function(){return M(n.id,n.onModalClose)},onSave:n.cb,title:n.title,question:n.question,initial:p,type:C,hint:h,validate:b})}return i.createElement(f,{key:n.id,isOpen:n.shown,onClose:function(){return M(n.id,n.onModalClose)},onSave:n.cb,title:n.title,question:n.question,initial:n.initial,type:n.type,hint:n.hint})}return"confirmation"===n.modalType?i.createElement(s,{key:n.id,isOpen:n.shown,prompt:n.prompt,confirmHandle:function(o){return t(void 0,void 0,void 0,(function(){return e(this,(function(t){switch(t.label){case 0:return[4,n.onConfirm(o)];case 1:return t.sent()&&M(n.id,n.onModalClose),[2,!0]}}))}))},closeHandle:function(){return M(n.id,n.onModalClose)},confirmText:n.confirmText,confirmType:n.confirmType,dontAskAgain:n.dontAskAgain}):null}))):null};export{m as ConfirmationListener,m as DynamicModal};
