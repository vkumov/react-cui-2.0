import t,{cloneElement as n}from"react";import"prop-types";import{c as e,a as o,d as i,e as r}from"../../tslib.es6-633881f1.js";import{e as l,E as u}from"../../index-74b9c8d0.js";import"../../style-inject.es-1f59c1d0.js";import{Button as c}from"../Button.js";import"formik";import"../Conditional.js";import"../InputHelpBlock.js";import"../Input.js";import"react-dom";import{ModalBody as a}from"./Body.js";import{ModalFooter as m}from"./Footer.js";import{Modal as s}from"./Modal.js";import"react-modal";import"./Header.js";import{ConfirmationModal as f}from"./ConfirmationModal.js";import{PromptModal as d}from"./PromptModal.js";var p=function(){var p=t.useState([]),y=p[0],v=p[1],h=t.useCallback((function(t){return v((function(n){return e(n,[o({id:Date.now(),shown:!0},t)])}))}),[]),k=t.useCallback((function(t){v((function(n){return n.map((function(n){return n.id===t?o(o({},n),{shown:!1}):n}))}))}),[]),C=t.useCallback((function(t){v((function(n){return n.filter((function(n){return n.id===t&&"function"==typeof n.onClosed&&n.onClosed(),n.id!==t}))}))}),[]),E=t.useCallback((function(t){k(t),setTimeout((function(){return C(t)}),500)}),[k,C]);return t.useEffect((function(){l.on(u.SHOW_MODAL,(function(t){return h(t)}))}),[h]),y.length?t.createElement(t.Fragment,null,y.map((function(e){if("dynamic"===e.modalType)return t.createElement(s,o({},e.modalProps,{key:e.id,isOpen:e.shown,closeIcon:!0,closeHandle:function(){return E(e.id)},title:e.title}),e.fullBody?"function"==typeof e.fullBody?e.fullBody({close:function(){return E(e.id)}}):n(e.fullBody,{close:function(){return E(e.id)}}):t.createElement(t.Fragment,null,t.createElement(a,null,e.body),t.createElement(m,null,e.buttons.map((function(n,o){return t.createElement(c,{key:o,color:n.color||"light",onClick:function(t){"function"==typeof n.onClick?n.onClick(t,(function(){return E(e.id)})):E(e.id)}},n.text)})))));if("notification"===e.modalType)return t.createElement(s,{key:e.id,isOpen:e.shown,closeIcon:!0,closeHandle:function(){return E(e.id)},title:e.title},t.createElement(a,null,e.body),t.createElement(m,null,t.createElement(c,{color:e.buttonColor||"light",onClick:function(){return E(e.id)}},e.button)));if("prompt"===e.modalType){if(void 0!==e.options){var l=e.options,u=l.initial,p=void 0===u?"":u,y=l.type,v=void 0===y?"text":y,h=l.hint,k=void 0===h?void 0:h,C=l.validate,b=void 0===C?void 0:C;return t.createElement(d,{key:e.id,isOpen:e.shown,onClose:function(){return E(e.id)},onSave:e.cb,title:e.title,question:e.question,initial:p,type:v,hint:k,validate:b})}return t.createElement(d,{key:e.id,isOpen:e.shown,onClose:function(){return E(e.id)},onSave:e.cb,title:e.title,question:e.question,initial:e.initial,type:e.type,hint:e.hint})}return"confirmation"===e.modalType?t.createElement(f,{key:e.id,isOpen:e.shown,prompt:e.prompt,confirmHandle:function(){return i(void 0,void 0,void 0,(function(){return r(this,(function(t){switch(t.label){case 0:return[4,e.onConfirm()];case 1:return t.sent()&&E(e.id),[2,!0]}}))}))},closeHandle:function(){return E(e.id)},confirmText:e.confirmText,confirmType:e.confirmType}):null}))):null};export{p as ConfirmationListener,p as DynamicModal};
