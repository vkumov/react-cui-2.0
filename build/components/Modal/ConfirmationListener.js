import{d as t,a as n,b as e,c as o}from"../../tslib.es6-a57c95d4.js";import i,{cloneElement as r}from"react";import{Button as l}from"../Button/index.js";import{e as u,E as c}from"../../eventManager-d70916fd.js";import{ModalBody as a}from"./Body.js";import{ModalFooter as d}from"./Footer.js";import{Modal as s}from"./Modal.js";import{ConfirmationModal as f}from"./ConfirmationModal.js";import{PromptModal as m}from"./PromptModal.js";import"../../index-fb409a55.js";import"../../style-inject.es-1f59c1d0.js";import"react-dom";import"react-modal";import"../Conditional.js";import"./Header.js";import"../Input/index.js";import"../InputHelpBlock.js";var p=function(){var p=i.useState([]),y=p[0],v=p[1],k=i.useCallback((function(e){return v((function(o){return t(t([],o,!0),[n({id:Date.now(),shown:!0},e)],!1)}))}),[]),h=i.useCallback((function(t){v((function(e){return e.map((function(e){return e.id===t?n(n({},e),{shown:!1}):e}))}))}),[]),C=i.useCallback((function(t){v((function(n){return n.filter((function(n){return n.id===t&&"function"==typeof n.onClosed&&n.onClosed(),n.id!==t}))}))}),[]),b=i.useCallback((function(t){h(t),setTimeout((function(){return C(t)}),500)}),[h,C]);return i.useEffect((function(){u.on(c.SHOW_MODAL,(function(t){return k(t)}))}),[k]),y.length?i.createElement(i.Fragment,null,y.map((function(t){if("dynamic"===t.modalType)return i.createElement(s,n({},t.modalProps,{key:t.id,isOpen:t.shown,closeHandle:function(){return b(t.id)},title:t.title}),t.fullBody?"function"==typeof t.fullBody?t.fullBody({close:function(){return b(t.id)}}):r(t.fullBody,{close:function(){return b(t.id)}}):i.createElement(i.Fragment,null,i.createElement(a,null,t.body),i.createElement(d,null,t.buttons.map((function(n,e){return i.createElement(l,{key:e,color:n.color||"light",onClick:function(e){"function"==typeof n.onClick?n.onClick(e,(function(){return b(t.id)})):b(t.id)}},n.text)})))));if("notification"===t.modalType)return i.createElement(s,{key:t.id,isOpen:t.shown,closeIcon:!0,closeHandle:function(){return b(t.id)},title:t.title},i.createElement(a,null,t.body),i.createElement(d,null,i.createElement(l,{color:t.buttonColor||"light",onClick:function(){return b(t.id)}},t.button)));if("prompt"===t.modalType){if(void 0!==t.options){var u=t.options,c=u.initial,p=void 0===c?"":c,y=u.type,v=void 0===y?"text":y,k=u.hint,h=void 0===k?void 0:k,C=u.validate,j=void 0===C?void 0:C;return i.createElement(m,{key:t.id,isOpen:t.shown,onClose:function(){return b(t.id)},onSave:t.cb,title:t.title,question:t.question,initial:p,type:v,hint:h,validate:j})}return i.createElement(m,{key:t.id,isOpen:t.shown,onClose:function(){return b(t.id)},onSave:t.cb,title:t.title,question:t.question,initial:t.initial,type:t.type,hint:t.hint})}return"confirmation"===t.modalType?i.createElement(f,{key:t.id,isOpen:t.shown,prompt:t.prompt,confirmHandle:function(n){return e(void 0,void 0,void 0,(function(){return o(this,(function(e){switch(e.label){case 0:return[4,t.onConfirm(n)];case 1:return e.sent()&&b(t.id),[2,!0]}}))}))},closeHandle:function(){return b(t.id)},confirmText:t.confirmText,confirmType:t.confirmType,dontAskAgain:t.dontAskAgain}):null}))):null};export{p as ConfirmationListener,p as DynamicModal};
