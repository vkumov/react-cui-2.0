import e from"react";import r from"prop-types";import"../_rollupPluginBabelHelpers-b60338eb.js";import{a}from"../index-be24eb93.js";import{s as o}from"../style-inject.es-1f59c1d0.js";import{getIn as i}from"formik";import{InputHelpBlock as l}from"./InputHelpBlock.js";import{Label as t}from"./Label.js";import{InputHelpBaloon as n}from"./InputHelpBaloon.js";o(".cui .form-group .chips .input{-moz-appearance:none;-webkit-appearance:none;background:var(--cui-form-background);border-radius:var(--cui-border-radius);border:var(--cui-border);box-shadow:none;color:var(--cui-form-value-color);flex-shrink:0;flex:1;font-family:var(--cui-font-stack);font-size:var(--cui-font-size);font-weight:var(--cui-form-value-font-weight);height:var(--cui-form-size);line-height:2.4rem;max-height:var(--cui-form-size);min-height:var(--cui-form-size);order:3;padding:var(--cui-form-padding);transition:all var(--cui-animate-speed) var(--cui-animate-timing-function);align-items:center;box-sizing:border-box;display:flex;position:relative}.cui .form-group .chips .input.focus,.cui .form-group .chips .input.hover,.cui .form-group .chips .input:focus,.cui .form-group .chips .input:hover{border-color:var(--cui-accent-color)}.cui .form-group .chips .input.focus,.cui .form-group .chips .input:focus{box-shadow:0 0 0 var(--cui-focus-thickness) rgba(var(--cui-focus-color),var(--cui-focus-opacity));opacity:1;outline:transparent var(--cui-focus-thickness);outline-offset:1px;outline-width:thin;outline-style:none}.cui .form-group .chips .input.disabled~label,.cui .form-group .chips .input[disabled]~label{opacity:.5;cursor:not-allowed!important;pointer-events:none!important;z-index:0!important}.cui .form-group .chips>.chips-outer{overflow:hidden;white-space:nowrap;padding-left:var(--cui-form-padding)}.cui .form-group .chips>.chips-outer>.chips-inner{white-space:normal}.cui .form-group .chips .input input{border:none;height:calc(var(--cui-form-size) - 2px);max-height:calc(var(--cui-form-size) - 2px);min-height:calc(var(--cui-form-size) - 2px);padding-top:calc(var(--cui-form-padding) - 1px);padding-bottom:calc(var(--cui-form-padding) - 1px);background:transparent}.cui .form-group .chips .input input:focus{box-shadow:unset}.cui .form-group.form-group--error .chips .input{border-color:var(--cui-theme-danger)}");const u=e.forwardRef(({className:r,field:o,label:u,form:{touched:c,errors:s,setFieldValue:p,setFieldTouched:m},chipsColor:f,addOnBlur:d,allowRegex:h,allowRepeat:g,delimiters:v,valueValidator:b,maxChips:y,baloon:x},w)=>{const[k,z]=e.useState(!1),C=e.useCallback(e=>{"function"==typeof b&&!1===(e=b(e))||(g?p(o.name,[...o.value,e]):o.value.includes(e)||p(o.name,[...o.value,e]))},[g,b,o.name,o.value]),E=e.useCallback(e=>{let r=v;if("string"==typeof r){const{map:e}=Array.prototype;r=e.call(r,e=>e.charCodeAt(0))}r.includes(e.keyCode)&&(C(e.target.value),e.target.value="",e.stopPropagation(),e.preventDefault())},[v,C]),N=e.useCallback(e=>{if(d&&e.target&&e.target.value){const{value:r}=e.target;h&&RegExp(h).test(r)?C(r):h||C(r)}e.target.value="",z(!1),o.onBlur()},[d,h,C,o]),R=e.useCallback(e=>{const r=[...o.value];r.splice(e,1),m(o.name,!0),p(o.name,r)},[o.name,o.value]);return e.useEffect(()=>{!Number.isNaN(y)&&Array.isArray(o.value)&&o.value.length>=y&&z(!1)},[o.value,y]),e.createElement("div",{className:`form-group${a(r)}${a(i(c,o.name)&&i(s,o.name),"form-group--error")}`,ref:w},e.createElement("div",{className:"form-group__text chips "+(k?"focused":"")},u?e.createElement("label",{htmlFor:"-"},u,x?e.createElement(n,{baloon:x}):null):null,e.createElement("div",{className:"input"},Array.isArray(o.value)&&o.value.length?e.createElement("span",{className:"chips-outer"},e.createElement("span",{className:"chips-inner"},o.value.map((r,a)=>e.createElement(t,{removable:!0,onRemove:()=>R(a),color:f,size:"tiny",key:`${r}-${a}`},r)))):null,!y||y&&Array.isArray(o.value)&&o.value.length<y?e.createElement("input",{type:"text",onKeyDown:E,onBlur:N,onFocus:()=>z(!0)}):null)),i(c,o.name)&&i(s,o.name)?e.createElement(l,{text:i(s,o.name)}):null)});u.propTypes={label:r.node,chipsColor:r.oneOf(["info","success","warning","warning-alt","danger","blue","dkgray","vibblue","indigo","default","ltgray","white","ghost"]),addOnBlur:r.bool,allowRepeat:r.bool,allowRegex:r.string,delimiters:r.oneOfType([r.string,r.arrayOf(r.number)]),valueValidator:r.func,maxChips:r.number,baloon:r.string,className:r.string,field:r.shape({name:r.any,value:r.any,onBlur:r.func}).isRequired,form:r.shape({touched:r.shape({}),errors:r.shape({}),setFieldValue:r.func,setFieldTouched:r.func}).isRequired},u.defaultProps={chipsColor:"default",addOnBlur:!0,delimiters:[13],label:null,allowRepeat:!1,allowRegex:null,valueValidator:null,maxChips:null,baloon:null,className:null};export{u as InputChips};
