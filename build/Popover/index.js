import{jsx as e,jsxs as j,Fragment as q}from"react/jsx-runtime";import{forwardRef as z,useRef as I,useEffect as ue,createContext as me,useContext as fe,useState as G,useCallback as A,useImperativeHandle as ve,cloneElement as he,createElement as ge}from"react";import{useMergeRefs as R,useFloatingTree as ye,useFloatingNodeId as _e,useFloating as H,offset as Q,flip as U,shift as W,autoUpdate as Y,useInteractions as $,useClick as V,useDismiss as X,FloatingNode as Pe,FloatingOverlay as xe,FloatingFocusManager as Z,FloatingPortal as Fe}from"@floating-ui/react";import P from"classnames";import{Transition as B}from"react-transition-group";import{useFloatingContext as ee,FloatingTreeWrapper as Oe}from"../FloatingProvider/index.js";import{useCustomDismiss as oe}from"../hooks/useCustomDismiss.js";import{useLockedBody as te}from"../hooks/useLockedBody.js";var x={wrapper:"Popover-module_wrapper__m7aDv",body:"Popover-module_body__ytz0O",popover_appear:"Popover-module_popover_appear__dJaAP",disappear:"Popover-module_disappear__w-dyh",popover_disappear:"Popover-module_popover_disappear__taph3",overlay:"Popover-module_overlay__u9dvj",overlay_appear:"Popover-module_overlay_appear__b1qOJ",overlay_disappear:"Popover-module_overlay_disappear__tQSBY"};const J=z(function({className:r,children:o,wrapperClassName:a,state:n,offset:t,...i},h){const u=I(null),m=R([h,u]);return ue(()=>{var p;const s=u.current;return s&&t&&typeof t!="function"&&s.style.setProperty("--offset",`${typeof t=="number"?t:(p=t.mainAxis)!=null?p:4}px`),()=>{s&&s.style.setProperty("--offset","4px")}},[t]),e("div",{ref:m,className:P(x.wrapper,a,{[x.disappear]:n==="exiting"||n==="exited"}),...i,children:e("div",{className:P("panel panel--bordered panel--raised",x.body,r),tabIndex:-1,children:o})})}),re=me(null),be=({children:r,...o})=>e(re.Provider,{value:o,children:r}),we=()=>fe(re),Ne=({show:r,children:o,background:a="var(--cui-background-color)",className:n})=>{const t=I(null);return e(B,{in:r,mountOnEnter:!0,unmountOnExit:!0,timeout:250,nodeRef:t,children:i=>e("div",{style:{background:a},className:P(x.overlay,n,{[x.disappear]:i==="exiting"||i==="exited"}),ref:t,children:o})})},Ce=z(function({children:r,element:o,onClose:a,onOpen:n,showClassName:t,overlay:i,showOverlay:h,placement:u,portalRoot:m,offset:p=4,closeRef:s,initialFocus:f,guardsFocus:c,modalFocus:F,closeOnFocusOut:O,portalId:E},b){const[g,l]=te(!1,"root"),k=ye(),y=_e(),{x:w,y:N,reference:T,floating:C,strategy:D,context:v}=H({placement:u,middleware:[Q(p),U(),W({padding:{left:8,right:8}})],open:g,onOpenChange:_=>{_&&typeof n=="function"&&n(),!_&&typeof a=="function"&&a(),l(_)},whileElementsMounted:Y,nodeId:y}),{getReferenceProps:M,getFloatingProps:d}=$([V(v),X(v,{escapeKey:!1,bubbles:!1}),oe(v)]),[S,le]=G(h),[ae,se]=G(i),ie=R([T,o.ref]),K=I(null),L=R([K,C]),{root:pe,id:ce}=ee({root:m,portalId:E,fallbackPortalId:"--cui-popover-portal"}),de=A(()=>l(!1),[l]);return s&&(s.current=de),ve(b,()=>({close:()=>l(!1),open:()=>l(!0)}),[l]),j(q,{children:[he(o,M({ref:ie,...o.props,className:P(o.props.className,t?{[t]:g}:void 0)})),e(Oe,{withPortal:!k,portalId:ce,portalRoot:pe,children:e(Pe,{id:y,children:e(B,{in:g,mountOnEnter:!0,unmountOnExit:!0,timeout:250,nodeRef:K,children:_=>e(xe,{style:{zIndex:"calc(var(--cui-max-zindex, 1000) + 2)"},id:y,children:e(Z,{context:v,initialFocus:f??L,guards:c,modal:F,closeOnFocusOut:O,children:e(J,{ref:L,style:{position:D,top:N??0,left:w??0},state:_,offset:p,...d(),children:j(be,{setOverlayState:le,setOverlay:se,children:[e(Ne,{show:S||!1,children:ae}),r]})})})})})})})]})}),ne=z(({className:r,noLine:o,...a},n)=>j(q,{children:[e("h5",{ref:n,className:P("no-margin-bottom",r),...a}),!o&&e("hr",{className:"half-margin-top"})]}));ne.displayName="PopoverTitle";function Ie({onClose:r,onOpen:o,popoverComponent:a=J,placement:n,initialFocus:t,guardsFocus:i,modalFocus:h,closeOnFocusOut:u,offset:m=4,portalRoot:p,portalId:s}){const[f,c]=te(!1,"root"),{x:F,y:O,reference:E,floating:b,strategy:g,context:l,refs:k}=H({placement:n,middleware:[Q(m),U(),W({padding:{left:8,right:8}})],open:f,onOpenChange:d=>{d&&typeof o=="function"&&o(),!d&&typeof r=="function"&&r(),c(d)},whileElementsMounted:Y}),{getReferenceProps:y,getFloatingProps:w}=$([V(l),X(l,{bubbles:!1,escapeKey:!1}),oe(l)]),N=A(()=>c(!1),[c]),T=A(()=>c(!0),[c]),C=I(null),D=R([C,b]),{root:v,id:M}=ee({root:p,portalId:s,fallbackPortalId:"--cui-popover-portal"});return{getReferenceProps:y,reference:E,render:d=>e(Fe,{root:v,id:M,children:e(B,{in:f,mountOnEnter:!0,unmountOnExit:!0,timeout:250,nodeRef:C,children:S=>e(Z,{context:l,initialFocus:t??b,guards:i,modal:h,closeOnFocusOut:u,children:ge(a,{ref:D,state:S,offset:m,...w({style:{position:g,top:O??0,left:F??0}})},d)})})}),isShown:f,refs:k,close:N,open:T}}export{J as GenericPopover,Ce as Popover,ne as PopoverTitle,Ie as usePopover,we as usePopoverContext};
//# sourceMappingURL=index.js.map
