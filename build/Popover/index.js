import{jsx as e,jsxs as j,Fragment as xe}from"react/jsx-runtime";import{forwardRef as z,useRef as P,useEffect as Oe,createContext as Q,useContext as U,useState as B,useCallback as J,useImperativeHandle as be,cloneElement as Fe,createElement as we}from"react";import{useMergeRefs as x,useFloatingTree as Ne,useFloatingNodeId as Ce,useFloating as Y,offset as G,flip as V,shift as W,autoUpdate as X,useInteractions as Z,useClick as ee,useDismiss as oe,FloatingNode as Re,FloatingOverlay as Ie,FloatingFocusManager as re,FloatingPortal as Ee}from"@floating-ui/react";import O from"classnames";import{Transition as K}from"react-transition-group";import{useFloatingContext as te,FloatingTreeWrapper as ke}from"../FloatingProvider/index.js";import{useCustomDismiss as ne}from"../hooks/useCustomDismiss.js";import{useLockedBody as le}from"../hooks/useLockedBody.js";var b={wrapper:"Popover-module_wrapper__m7aDv",body:"Popover-module_body__ytz0O",popover_appear:"Popover-module_popover_appear__dJaAP",disappear:"Popover-module_disappear__w-dyh",popover_disappear:"Popover-module_popover_disappear__taph3",overlay:"Popover-module_overlay__u9dvj",overlay_appear:"Popover-module_overlay_appear__b1qOJ",overlay_disappear:"Popover-module_overlay_disappear__tQSBY"};const $=z(function({className:o,children:r,wrapperClassName:l,state:n,offset:t,...s},h){const m=P(null),f=x([h,m]);return Oe(()=>{var c;const a=m.current;return a&&t&&typeof t!="function"&&a.style.setProperty("--offset",`${typeof t=="number"?t:(c=t.mainAxis)!=null?c:4}px`),()=>{a&&a.style.setProperty("--offset","4px")}},[t]),e("div",{ref:f,className:O(b.wrapper,l,{[b.disappear]:n==="exiting"||n==="exited"}),...s,children:e("div",{className:O("panel panel--bordered panel--raised",b.body,o),tabIndex:-1,children:r})})}),ae=Q(null),De=({children:o,...r})=>e(ae.Provider,{value:r,children:o}),Me=()=>U(ae),Te=({show:o,children:r,background:l="var(--cui-background-color)",className:n})=>{const t=P(null);return e(K,{in:o,mountOnEnter:!0,unmountOnExit:!0,timeout:250,nodeRef:t,children:s=>e("div",{style:{background:l},className:O(b.overlay,n,{[b.disappear]:s==="exiting"||s==="exited"}),ref:t,children:r})})},se=Q(null),Ae=()=>{const o=U(se);if(o)return o.current},Se=z(function({children:o,element:r,onClose:l,onOpen:n,showClassName:t,overlay:s,showOverlay:h,placement:m,portalRoot:f,offset:c=4,closeRef:a,initialFocus:v,guardsFocus:d,modalFocus:F,closeOnFocusOut:w,portalId:k,wrapperClassName:N,className:D,explicitPortal:u,autoDismiss:M=!0},T){const[g,i]=le(!1,"root"),[C,R]=B(M),A=Ne(),y=Ce(),{x:I,y:p,reference:S,floating:pe,strategy:ce,context:E}=Y({placement:m,middleware:[G(c),V(),W({padding:{left:8,right:8}})],open:g,onOpenChange:_=>{_&&typeof n=="function"&&n(),!_&&typeof l=="function"&&l(),i(_)},whileElementsMounted:X,nodeId:y}),{getReferenceProps:de,getFloatingProps:ue}=Z([ee(E),oe(E,{escapeKey:!1,bubbles:!1,enabled:C}),ne(E,{enabled:C})]),[me,fe]=B(h),[ve,he]=B(s),ge=x([S,r.ref]),q=P(null),H=x([q,pe]),{root:ye,id:_e}=te({root:f,portalId:k,fallbackPortalId:"--cui-popover-portal"}),Pe=J(()=>i(!1),[i]);a&&(a.current=Pe);const L=P(null);return be(x([T,L]),()=>({close:()=>i(!1),open:()=>i(!0),setAutoDismiss:R}),[i]),j(se.Provider,{value:L,children:[Fe(r,de({ref:ge,...r.props,className:O(r.props.className,t?{[t]:g}:void 0)})),e(ke,{withPortal:u||!A,portalId:_e,portalRoot:ye,force:u?!0:void 0,children:e(Re,{id:y,children:e(K,{in:g,mountOnEnter:!0,unmountOnExit:!0,timeout:250,nodeRef:q,children:_=>e(Ie,{style:{zIndex:"calc(var(--cui-max-zindex, 1000) + 2)"},id:y,children:e(re,{context:E,initialFocus:v??H,guards:d,modal:F,closeOnFocusOut:w,children:e($,{ref:H,style:{position:ce,top:p??0,left:I??0},state:_,offset:c,wrapperClassName:N,...ue({className:D}),children:j(De,{setOverlayState:fe,setOverlay:he,children:[e(Te,{show:me||!1,children:ve}),o]})})})})})})})]})}),ie=z(({className:o,noLine:r,...l},n)=>j(xe,{children:[e("h5",{ref:n,className:O("no-margin-bottom",o),...l}),!r&&e("hr",{className:"half-margin-top"})]}));ie.displayName="PopoverTitle";function je({onClose:o,onOpen:r,popoverComponent:l=$,placement:n,initialFocus:t,guardsFocus:s,modalFocus:h,closeOnFocusOut:m,offset:f=4,portalRoot:c,portalId:a}){const[v,d]=le(!1,"root"),{x:F,y:w,reference:k,floating:N,strategy:D,context:u,refs:M}=Y({placement:n,middleware:[G(f),V(),W({padding:{left:8,right:8}})],open:v,onOpenChange:p=>{p&&typeof r=="function"&&r(),!p&&typeof o=="function"&&o(),d(p)},whileElementsMounted:X}),{getReferenceProps:T,getFloatingProps:g}=Z([ee(u),oe(u,{bubbles:!1,escapeKey:!1}),ne(u)]),i=J(()=>d(!1),[d]),C=J(()=>d(!0),[d]),R=P(null),A=x([R,N]),{root:y,id:I}=te({root:c,portalId:a,fallbackPortalId:"--cui-popover-portal"});return{getReferenceProps:T,reference:k,render:p=>e(Ee,{root:y,id:I,children:e(K,{in:v,mountOnEnter:!0,unmountOnExit:!0,timeout:250,nodeRef:R,children:S=>e(re,{context:u,initialFocus:t??N,guards:s,modal:h,closeOnFocusOut:m,children:we(l,{ref:A,state:S,offset:f,...g({style:{position:D,top:w??0,left:F??0}})},p)})})}),isShown:v,refs:M,close:i,open:C}}export{$ as GenericPopover,Se as Popover,ie as PopoverTitle,je as usePopover,Me as usePopoverContext,Ae as usePopoverHandlers};
//# sourceMappingURL=index.js.map
