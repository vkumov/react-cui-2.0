function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function _iterableToArrayLimit(arr,i){var _i=arr==null?null:typeof Symbol!=="undefined"&&arr[Symbol.iterator]||arr["@@iterator"];if(_i==null)return;var _arr=[];var _n=true;var _d=false;var _s,_e;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};var ownKeys=Object.keys(source);if(typeof Object.getOwnPropertySymbols==="function"){ownKeys=ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function(sym){return Object.getOwnPropertyDescriptor(source,sym).enumerable}))}ownKeys.forEach(function(key){_defineProperty(target,key,source[key])})}return target}function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly){symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable})}keys.push.apply(keys,symbols)}return keys}function _objectSpreadProps(target,source){source=source!=null?source:{};if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{ownKeys(Object(source)).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))})}return target}function _objectWithoutProperties(source,excluded){if(source==null)return{};var target=_objectWithoutPropertiesLoose(source,excluded);var key,i;if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++){key=sourceSymbolKeys[i];if(excluded.indexOf(key)>=0)continue;if(!Object.prototype.propertyIsEnumerable.call(source,key))continue;target[key]=source[key]}}return target}function _objectWithoutPropertiesLoose(source,excluded){if(source==null)return{};var target={};var sourceKeys=Object.keys(source);var key,i;for(i=0;i<sourceKeys.length;i++){key=sourceKeys[i];if(excluded.indexOf(key)>=0)continue;target[key]=source[key]}return target}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_unsupportedIterableToArray(arr,i)||_nonIterableRest()}function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(n);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}import React,{forwardRef,useRef,useEffect,useContext,createContext,useState,useCallback,cloneElement,createElement}from"react";import{useMergeRefs,useFloating,offset,flip,shift,autoUpdate,useDismiss,useClick,useInteractions,FloatingPortal,FloatingFocusManager}from"@floating-ui/react";import cx from"classnames";import{Transition}from"react-transition-group";import{useFloatingContext}from"../FloatingProvider/index.js";import{useLockedBody}from"../hooks/useLockedBody.js";var styles={"wrapper":"Popover-module_wrapper__m7aDv","body":"Popover-module_body__ytz0O","popover_appear":"Popover-module_popover_appear__dJaAP","disappear":"Popover-module_disappear__w-dyh","popover_disappear":"Popover-module_popover_disappear__taph3","overlay":"Popover-module_overlay__u9dvj","overlay_appear":"Popover-module_overlay_appear__b1qOJ","overlay_disappear":"Popover-module_overlay_disappear__tQSBY"};function _extends$2(){_extends$2=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return _extends$2.apply(this,arguments)}var GenericPopover=forwardRef(function GenericPopoverRefed(_param,ref){var className=_param.className,children=_param.children,wrapperClassName=_param.wrapperClassName,state=_param.state,offsetOptions=_param.offset,props=_objectWithoutProperties(_param,["className","children","wrapperClassName","state","offset"]);var ownRef=useRef(null);var merged=useMergeRefs([ref,ownRef]);useEffect(function(){var r=ownRef.current;var _mainAxis;if(r&&offsetOptions&&typeof offsetOptions!=="function")r.style.setProperty("--offset","".concat(typeof offsetOptions==="number"?offsetOptions:(_mainAxis=offsetOptions.mainAxis)!==null&&_mainAxis!==void 0?_mainAxis:4,"px"));return function(){if(r)r.style.setProperty("--offset","4px")}},[offsetOptions]);return React.createElement("div",_extends$2({ref:merged,className:cx(styles.wrapper,wrapperClassName,_defineProperty({},styles.disappear,state==="exiting"||state==="exited"))},props),React.createElement("div",{className:cx("panel panel--bordered panel--raised",styles.body,className)},children))});var PopoverContext=createContext(null);var PopoverProvider=function(_param){var children=_param.children,props=_objectWithoutProperties(_param,["children"]);return React.createElement(PopoverContext.Provider,{value:props},children)};var usePopoverContext=function(){return useContext(PopoverContext)};function _extends$1(){_extends$1=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return _extends$1.apply(this,arguments)}var Overlay=function(param){var show=param.show,children=param.children,_background=param.background,background=_background===void 0?"var(--cui-background-color)":_background,className=param.className;var ref=useRef(null);return React.createElement(Transition,{in:show,mountOnEnter:true,unmountOnExit:true,timeout:250,nodeRef:ref},function(state){return React.createElement("div",{style:{background:background},className:cx(styles.overlay,className,_defineProperty({},styles.disappear,state==="exiting"||state==="exited")),ref:ref},children)})};var Popover=function(param){var children=param.children,element=param.element,onClose=param.onClose,onOpen=param.onOpen,showClassName=param.showClassName,overlayProvided=param.overlay,overlayShowProvided=param.showOverlay,placement=param.placement,portalRoot=param.portalRoot,tmp=param.offset,offsetOptions=tmp===void 0?4:tmp,closeRef=param.closeRef,initialFocus=param.initialFocus,guardsFocus=param.guardsFocus,modalFocus=param.modalFocus,closeOnFocusOut=param.closeOnFocusOut;var ref;var ref1=_slicedToArray(useLockedBody(false,"root"),2),show=ref1[0],setShow=ref1[1];var ref2=useFloating({placement:placement,middleware:[offset(offsetOptions),flip(),shift({padding:{left:8,right:8}})],open:show,onOpenChange:function(newOpen){if(newOpen&&typeof onOpen==="function")onOpen();if(!newOpen&&typeof onClose==="function")onClose();setShow(newOpen)},whileElementsMounted:autoUpdate}),x=ref2.x,y=ref2.y,reference=ref2.reference,floating=ref2.floating,strategy=ref2.strategy,context=ref2.context;var dismiss=useDismiss(context);var click=useClick(context);var ref3=useInteractions([click,dismiss]),getReferenceProps=ref3.getReferenceProps,getFloatingProps=ref3.getFloatingProps;var ref4=_slicedToArray(useState(overlayShowProvided),2),overlayShow=ref4[0],setOverlayShow=ref4[1];var ref5=_slicedToArray(useState(overlayProvided),2),overlay=ref5[0],setOverlay=ref5[1];var ref11=useMergeRefs([reference,element.ref]);var transitionRef=useRef(null);var floatingRef=useMergeRefs([transitionRef,floating]);var rootCtx=useFloatingContext();portalRoot!==null&&portalRoot!==void 0?portalRoot:portalRoot=(rootCtx===null||rootCtx===void 0?void 0:(ref=rootCtx.rootRef)===null||ref===void 0?void 0:ref.current)||undefined;var closeCb=useCallback(function(){return setShow(false)},[setShow]);if(closeRef)closeRef.current=closeCb;return React.createElement(React.Fragment,null,cloneElement(element,getReferenceProps(_objectSpreadProps(_objectSpread({ref:ref11},element.props),{className:cx(element.props.className,showClassName?_defineProperty({},showClassName,show):undefined)}))),React.createElement(Transition,{in:show,mountOnEnter:true,unmountOnExit:true,timeout:250,nodeRef:transitionRef},function(state){return React.createElement(FloatingPortal,{root:portalRoot},React.createElement(FloatingFocusManager,{context:context,initialFocus:initialFocus,guards:guardsFocus,modal:modalFocus,closeOnFocusOut:closeOnFocusOut},React.createElement(GenericPopover,_extends$1({ref:floatingRef,style:{position:strategy,top:y!==null&&y!==void 0?y:0,left:x!==null&&x!==void 0?x:0},state:state,offset:offsetOptions},getFloatingProps()),React.createElement(PopoverProvider,{setOverlayState:setOverlayShow,setOverlay:setOverlay},React.createElement(Overlay,{show:overlayShow||false},overlay),children))))}))};function _extends(){_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return _extends.apply(this,arguments)}var PopoverTitle=forwardRef(function(_param,ref){var className=_param.className,noLine=_param.noLine,props=_objectWithoutProperties(_param,["className","noLine"]);return React.createElement(React.Fragment,null,React.createElement("h5",_extends({ref:ref,className:cx("no-margin-bottom",className)},props)),!noLine&&React.createElement("hr",{className:"half-margin-top"}))});PopoverTitle.displayName="PopoverTitle";function usePopover(param){var onClose=param.onClose,onOpen=param.onOpen,_popoverComponent=param.popoverComponent,popoverComponent=_popoverComponent===void 0?GenericPopover:_popoverComponent,placement=param.placement,initialFocus=param.initialFocus,guardsFocus=param.guardsFocus,modalFocus=param.modalFocus,closeOnFocusOut=param.closeOnFocusOut,tmp=param.offset,offsetOptions=tmp===void 0?4:tmp,portalRoot=param.portalRoot;var ref;var ref1=_slicedToArray(useLockedBody(false,"root"),2),show=ref1[0],setShow=ref1[1];var ref2=useFloating({placement:placement,middleware:[offset(offsetOptions),flip(),shift({padding:{left:8,right:8}})],open:show,onOpenChange:function(newOpen){if(newOpen&&typeof onOpen==="function")onOpen();if(!newOpen&&typeof onClose==="function")onClose();setShow(newOpen)},whileElementsMounted:autoUpdate}),x=ref2.x,y=ref2.y,reference=ref2.reference,floating=ref2.floating,strategy=ref2.strategy,context=ref2.context,refs=ref2.refs;var dismiss=useDismiss(context);var click=useClick(context);var ref3=useInteractions([click,dismiss]),getReferenceProps=ref3.getReferenceProps,getFloatingProps=ref3.getFloatingProps;var closeCb=useCallback(function(){return setShow(false)},[setShow]);var openCb=useCallback(function(){return setShow(true)},[setShow]);var transitionRef=useRef(null);var floatingRef=useMergeRefs([transitionRef,floating]);var rootCtx=useFloatingContext();portalRoot!==null&&portalRoot!==void 0?portalRoot:portalRoot=(rootCtx===null||rootCtx===void 0?void 0:(ref=rootCtx.rootRef)===null||ref===void 0?void 0:ref.current)||undefined;var render=function(body){return React.createElement(Transition,{in:show,mountOnEnter:true,unmountOnExit:true,timeout:250,nodeRef:transitionRef},function(state){return React.createElement(FloatingPortal,{root:portalRoot},React.createElement(FloatingFocusManager,{context:context,initialFocus:initialFocus,guards:guardsFocus,modal:modalFocus,closeOnFocusOut:closeOnFocusOut},createElement(popoverComponent,_objectSpread({ref:floatingRef,state:state,offset:offsetOptions},getFloatingProps({style:{position:strategy,top:y!==null&&y!==void 0?y:0,left:x!==null&&x!==void 0?x:0}})),body)))})};return{getReferenceProps:getReferenceProps,reference:reference,render:render,isShown:show,refs:refs,close:closeCb,open:openCb}}export{GenericPopover,Popover,PopoverTitle,usePopover,usePopoverContext};
//# sourceMappingURL=index.js.map
