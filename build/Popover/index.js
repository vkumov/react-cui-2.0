import e,{forwardRef as j,useRef as R,useEffect as ie,createContext as ce,useContext as ue,useState as q,useCallback as z,cloneElement as me,createElement as de}from"react";import{useMergeRefs as C,useFloatingTree as fe,useFloatingNodeId as ve,useFloating as G,offset as J,flip as U,shift as W,autoUpdate as H,useInteractions as Q,useClick as Y,useDismiss as $,FloatingNode as ge,FloatingOverlay as ye,FloatingFocusManager as V,FloatingPortal as Ee}from"@floating-ui/react";import F from"classnames";import{Transition as A}from"react-transition-group";import{useFloatingContext as X,FloatingTreeWrapper as _e}from"../FloatingProvider/index.js";import{useCustomDismiss as Z}from"../hooks/useCustomDismiss.js";import{useLockedBody as ee}from"../hooks/useLockedBody.js";var O={wrapper:"Popover-module_wrapper__m7aDv",body:"Popover-module_body__ytz0O",popover_appear:"Popover-module_popover_appear__dJaAP",disappear:"Popover-module_disappear__w-dyh",popover_disappear:"Popover-module_popover_disappear__taph3",overlay:"Popover-module_overlay__u9dvj",overlay_appear:"Popover-module_overlay_appear__b1qOJ",overlay_disappear:"Popover-module_overlay_disappear__tQSBY"};const B=j(function({className:r,children:o,wrapperClassName:a,state:n,offset:t,...s},y){const u=R(null),m=C([y,u]);return ie(()=>{var p;const l=u.current;return l&&t&&typeof t!="function"&&l.style.setProperty("--offset",`${typeof t=="number"?t:(p=t.mainAxis)!=null?p:4}px`),()=>{l&&l.style.setProperty("--offset","4px")}},[t]),e.createElement("div",{ref:m,className:F(O.wrapper,a,{[O.disappear]:n==="exiting"||n==="exited"}),...s},e.createElement("div",{className:F("panel panel--bordered panel--raised",O.body,r),tabIndex:-1},o))}),oe=ce(null),Pe=({children:r,...o})=>e.createElement(oe.Provider,{value:o},r),Fe=()=>ue(oe),Oe=({show:r,children:o,background:a="var(--cui-background-color)",className:n})=>{const t=R(null);return e.createElement(A,{in:r,mountOnEnter:!0,unmountOnExit:!0,timeout:250,nodeRef:t},s=>e.createElement("div",{style:{background:a},className:F(O.overlay,n,{[O.disappear]:s==="exiting"||s==="exited"}),ref:t},o))},xe=({children:r,element:o,onClose:a,onOpen:n,showClassName:t,overlay:s,showOverlay:y,placement:u,portalRoot:m,offset:p=4,closeRef:l,initialFocus:d,guardsFocus:i,modalFocus:x,closeOnFocusOut:h,portalId:I})=>{const[f,E]=ee(!1,"root"),v=fe(),_=ve(),{x:b,y:w,reference:k,floating:M,strategy:N,context:g}=G({placement:u,middleware:[J(p),U(),W({padding:{left:8,right:8}})],open:f,onOpenChange:P=>{P&&typeof n=="function"&&n(),!P&&typeof a=="function"&&a(),E(P)},whileElementsMounted:H,nodeId:_}),{getReferenceProps:T,getFloatingProps:S}=Q([Y(g),$(g,{escapeKey:!1,bubbles:!1}),Z(g)]),[c,D]=q(y),[re,ne]=q(s),ae=C([k,o.ref]),K=R(null),L=C([K,M]),{root:le,id:se}=X({root:m,portalId:I,fallbackPortalId:"--cui-popover-portal"}),pe=z(()=>E(!1),[E]);return l&&(l.current=pe),e.createElement(e.Fragment,null,me(o,T({ref:ae,...o.props,className:F(o.props.className,t?{[t]:f}:void 0)})),e.createElement(_e,{withPortal:!v,portalId:se,portalRoot:le},e.createElement(ge,{id:_},e.createElement(A,{in:f,mountOnEnter:!0,unmountOnExit:!0,timeout:250,nodeRef:K},P=>e.createElement(ye,{style:{zIndex:50},id:_},e.createElement(V,{context:g,initialFocus:d??L,guards:i,modal:x,closeOnFocusOut:h},e.createElement(B,{ref:L,style:{position:N,top:w??0,left:b??0},state:P,offset:p,...S()},e.createElement(Pe,{setOverlayState:D,setOverlay:ne},e.createElement(Oe,{show:c||!1},re),r))))))))},te=j(({className:r,noLine:o,...a},n)=>e.createElement(e.Fragment,null,e.createElement("h5",{ref:n,className:F("no-margin-bottom",r),...a}),!o&&e.createElement("hr",{className:"half-margin-top"})));te.displayName="PopoverTitle";function he({onClose:r,onOpen:o,popoverComponent:a=B,placement:n,initialFocus:t,guardsFocus:s,modalFocus:y,closeOnFocusOut:u,offset:m=4,portalRoot:p,portalId:l}){const[d,i]=ee(!1,"root"),{x,y:h,reference:I,floating:f,strategy:E,context:v,refs:_}=G({placement:n,middleware:[J(m),U(),W({padding:{left:8,right:8}})],open:d,onOpenChange:c=>{c&&typeof o=="function"&&o(),!c&&typeof r=="function"&&r(),i(c)},whileElementsMounted:H}),{getReferenceProps:b,getFloatingProps:w}=Q([Y(v),$(v,{bubbles:!1,escapeKey:!1}),Z(v)]),k=z(()=>i(!1),[i]),M=z(()=>i(!0),[i]),N=R(null),g=C([N,f]),{root:T,id:S}=X({root:p,portalId:l,fallbackPortalId:"--cui-popover-portal"});return{getReferenceProps:b,reference:I,render:c=>e.createElement(Ee,{root:T,id:S},e.createElement(A,{in:d,mountOnEnter:!0,unmountOnExit:!0,timeout:250,nodeRef:N},D=>e.createElement(V,{context:v,initialFocus:t??f,guards:s,modal:y,closeOnFocusOut:u},de(a,{ref:g,state:D,offset:m,...w({style:{position:E,top:h??0,left:x??0}})},c)))),isShown:d,refs:_,close:k,open:M}}export{B as GenericPopover,xe as Popover,te as PopoverTitle,he as usePopover,Fe as usePopoverContext};
//# sourceMappingURL=index.js.map
