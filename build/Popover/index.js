import{jsx as e,jsxs as j,Fragment as L}from"react/jsx-runtime";import{forwardRef as q,useRef as R,useEffect as de,createContext as ue,useContext as me,useState as G,useCallback as z,cloneElement as fe,createElement as ve}from"react";import{useMergeRefs as E,useFloatingTree as he,useFloatingNodeId as ge,useFloating as U,offset as W,flip as H,shift as Q,autoUpdate as Y,useInteractions as V,useClick as X,useDismiss as Z,FloatingNode as ye,FloatingOverlay as _e,FloatingFocusManager as $,FloatingPortal as Pe}from"@floating-ui/react";import x from"classnames";import{Transition as A}from"react-transition-group";import{useFloatingContext as ee,FloatingTreeWrapper as xe}from"../FloatingProvider/index.js";import{useCustomDismiss as oe}from"../hooks/useCustomDismiss.js";import{useLockedBody as te}from"../hooks/useLockedBody.js";var F={wrapper:"Popover-module_wrapper__m7aDv",body:"Popover-module_body__ytz0O",popover_appear:"Popover-module_popover_appear__dJaAP",disappear:"Popover-module_disappear__w-dyh",popover_disappear:"Popover-module_popover_disappear__taph3",overlay:"Popover-module_overlay__u9dvj",overlay_appear:"Popover-module_overlay_appear__b1qOJ",overlay_disappear:"Popover-module_overlay_disappear__tQSBY"};const B=q(function({className:r,children:o,wrapperClassName:l,state:n,offset:t,...s},g){const d=R(null),u=E([g,d]);return de(()=>{var i;const a=d.current;return a&&t&&typeof t!="function"&&a.style.setProperty("--offset",`${typeof t=="number"?t:(i=t.mainAxis)!=null?i:4}px`),()=>{a&&a.style.setProperty("--offset","4px")}},[t]),e("div",{ref:u,className:x(F.wrapper,l,{[F.disappear]:n==="exiting"||n==="exited"}),...s,children:e("div",{className:x("panel panel--bordered panel--raised",F.body,r),tabIndex:-1,children:o})})}),re=ue(null),Fe=({children:r,...o})=>e(re.Provider,{value:o,children:r}),Oe=()=>me(re),be=({show:r,children:o,background:l="var(--cui-background-color)",className:n})=>{const t=R(null);return e(A,{in:r,mountOnEnter:!0,unmountOnExit:!0,timeout:250,nodeRef:t,children:s=>e("div",{style:{background:l},className:x(F.overlay,n,{[F.disappear]:s==="exiting"||s==="exited"}),ref:t,children:o})})},we=({children:r,element:o,onClose:l,onOpen:n,showClassName:t,overlay:s,showOverlay:g,placement:d,portalRoot:u,offset:i=4,closeRef:a,initialFocus:m,guardsFocus:p,modalFocus:O,closeOnFocusOut:b,portalId:I})=>{const[f,y]=te(!1,"root"),v=he(),_=ge(),{x:w,y:N,reference:k,floating:T,strategy:C,context:h}=U({placement:d,middleware:[W(i),H(),Q({padding:{left:8,right:8}})],open:f,onOpenChange:P=>{P&&typeof n=="function"&&n(),!P&&typeof l=="function"&&l(),y(P)},whileElementsMounted:Y,nodeId:_}),{getReferenceProps:D,getFloatingProps:M}=V([X(h),Z(h,{escapeKey:!1,bubbles:!1}),oe(h)]),[c,S]=G(g),[le,ae]=G(s),se=E([k,o.ref]),J=R(null),K=E([J,T]),{root:ie,id:pe}=ee({root:u,portalId:I,fallbackPortalId:"--cui-popover-portal"}),ce=z(()=>y(!1),[y]);return a&&(a.current=ce),j(L,{children:[fe(o,D({ref:se,...o.props,className:x(o.props.className,t?{[t]:f}:void 0)})),e(xe,{withPortal:!v,portalId:pe,portalRoot:ie,children:e(ye,{id:_,children:e(A,{in:f,mountOnEnter:!0,unmountOnExit:!0,timeout:250,nodeRef:J,children:P=>e(_e,{style:{zIndex:"calc(var(--cui-max-zindex, 1000) + 2)"},id:_,children:e($,{context:h,initialFocus:m??K,guards:p,modal:O,closeOnFocusOut:b,children:e(B,{ref:K,style:{position:C,top:N??0,left:w??0},state:P,offset:i,...M(),children:j(Fe,{setOverlayState:S,setOverlay:ae,children:[e(be,{show:c||!1,children:le}),r]})})})})})})})]})},ne=q(({className:r,noLine:o,...l},n)=>j(L,{children:[e("h5",{ref:n,className:x("no-margin-bottom",r),...l}),!o&&e("hr",{className:"half-margin-top"})]}));ne.displayName="PopoverTitle";function Ne({onClose:r,onOpen:o,popoverComponent:l=B,placement:n,initialFocus:t,guardsFocus:s,modalFocus:g,closeOnFocusOut:d,offset:u=4,portalRoot:i,portalId:a}){const[m,p]=te(!1,"root"),{x:O,y:b,reference:I,floating:f,strategy:y,context:v,refs:_}=U({placement:n,middleware:[W(u),H(),Q({padding:{left:8,right:8}})],open:m,onOpenChange:c=>{c&&typeof o=="function"&&o(),!c&&typeof r=="function"&&r(),p(c)},whileElementsMounted:Y}),{getReferenceProps:w,getFloatingProps:N}=V([X(v),Z(v,{bubbles:!1,escapeKey:!1}),oe(v)]),k=z(()=>p(!1),[p]),T=z(()=>p(!0),[p]),C=R(null),h=E([C,f]),{root:D,id:M}=ee({root:i,portalId:a,fallbackPortalId:"--cui-popover-portal"});return{getReferenceProps:w,reference:I,render:c=>e(Pe,{root:D,id:M,children:e(A,{in:m,mountOnEnter:!0,unmountOnExit:!0,timeout:250,nodeRef:C,children:S=>e($,{context:v,initialFocus:t??f,guards:s,modal:g,closeOnFocusOut:d,children:ve(l,{ref:h,state:S,offset:u,...N({style:{position:y,top:b??0,left:O??0}})},c)})})}),isShown:m,refs:_,close:k,open:T}}export{B as GenericPopover,we as Popover,ne as PopoverTitle,Ne as usePopover,Oe as usePopoverContext};
//# sourceMappingURL=index.js.map
