import{jsx as e,jsxs as z,Fragment as q}from"react/jsx-runtime";import{forwardRef as D,useRef as C,useEffect as fe,createContext as ve,useContext as he,useState as G,useCallback as A,useImperativeHandle as ge,cloneElement as ye,createElement as _e}from"react";import{useMergeRefs as I,useFloatingTree as Pe,useFloatingNodeId as xe,useFloating as Q,offset as U,flip as H,shift as V,autoUpdate as W,useInteractions as X,useClick as Y,useDismiss as $,FloatingNode as Fe,FloatingOverlay as Oe,FloatingFocusManager as Z,FloatingPortal as be}from"@floating-ui/react";import x from"classnames";import{Transition as B}from"react-transition-group";import{useFloatingContext as ee,FloatingTreeWrapper as we}from"../FloatingProvider/index.js";import{useCustomDismiss as oe}from"../hooks/useCustomDismiss.js";import{useLockedBody as re}from"../hooks/useLockedBody.js";var F={wrapper:"Popover-module_wrapper__m7aDv",body:"Popover-module_body__ytz0O",popover_appear:"Popover-module_popover_appear__dJaAP",disappear:"Popover-module_disappear__w-dyh",popover_disappear:"Popover-module_popover_disappear__taph3",overlay:"Popover-module_overlay__u9dvj",overlay_appear:"Popover-module_overlay_appear__b1qOJ",overlay_disappear:"Popover-module_overlay_disappear__tQSBY"};const J=D(function({className:t,children:o,wrapperClassName:a,state:n,offset:r,...i},h){const u=C(null),m=I([h,u]);return fe(()=>{var c;const s=u.current;return s&&r&&typeof r!="function"&&s.style.setProperty("--offset",`${typeof r=="number"?r:(c=r.mainAxis)!=null?c:4}px`),()=>{s&&s.style.setProperty("--offset","4px")}},[r]),e("div",{ref:m,className:x(F.wrapper,a,{[F.disappear]:n==="exiting"||n==="exited"}),...i,children:e("div",{className:x("panel panel--bordered panel--raised",F.body,t),tabIndex:-1,children:o})})}),te=ve(null),Ne=({children:t,...o})=>e(te.Provider,{value:o,children:t}),Ce=()=>he(te),Ie=({show:t,children:o,background:a="var(--cui-background-color)",className:n})=>{const r=C(null);return e(B,{in:t,mountOnEnter:!0,unmountOnExit:!0,timeout:250,nodeRef:r,children:i=>e("div",{style:{background:a},className:x(F.overlay,n,{[F.disappear]:i==="exiting"||i==="exited"}),ref:r,children:o})})},Re=D(function({children:t,element:o,onClose:a,onOpen:n,showClassName:r,overlay:i,showOverlay:h,placement:u,portalRoot:m,offset:c=4,closeRef:s,initialFocus:f,guardsFocus:d,modalFocus:O,closeOnFocusOut:b,portalId:R,wrapperClassName:w,className:E},v){const[g,p]=re(!1,"root"),k=Pe(),y=xe(),{x:N,y:_,reference:T,floating:M,strategy:S,context:l}=Q({placement:u,middleware:[U(c),H(),V({padding:{left:8,right:8}})],open:g,onOpenChange:P=>{P&&typeof n=="function"&&n(),!P&&typeof a=="function"&&a(),p(P)},whileElementsMounted:W,nodeId:y}),{getReferenceProps:j,getFloatingProps:ae}=X([Y(l),$(l,{escapeKey:!1,bubbles:!1}),oe(l)]),[le,se]=G(h),[ie,pe]=G(i),ce=I([T,o.ref]),K=C(null),L=I([K,M]),{root:de,id:ue}=ee({root:m,portalId:R,fallbackPortalId:"--cui-popover-portal"}),me=A(()=>p(!1),[p]);return s&&(s.current=me),ge(v,()=>({close:()=>p(!1),open:()=>p(!0)}),[p]),z(q,{children:[ye(o,j({ref:ce,...o.props,className:x(o.props.className,r?{[r]:g}:void 0)})),e(we,{withPortal:!k,portalId:ue,portalRoot:de,children:e(Fe,{id:y,children:e(B,{in:g,mountOnEnter:!0,unmountOnExit:!0,timeout:250,nodeRef:K,children:P=>e(Oe,{style:{zIndex:"calc(var(--cui-max-zindex, 1000) + 2)"},id:y,children:e(Z,{context:l,initialFocus:f??L,guards:d,modal:O,closeOnFocusOut:b,children:e(J,{ref:L,style:{position:S,top:_??0,left:N??0},state:P,offset:c,wrapperClassName:w,...ae({className:E}),children:z(Ne,{setOverlayState:se,setOverlay:pe,children:[e(Ie,{show:le||!1,children:ie}),t]})})})})})})})]})}),ne=D(({className:t,noLine:o,...a},n)=>z(q,{children:[e("h5",{ref:n,className:x("no-margin-bottom",t),...a}),!o&&e("hr",{className:"half-margin-top"})]}));ne.displayName="PopoverTitle";function Ee({onClose:t,onOpen:o,popoverComponent:a=J,placement:n,initialFocus:r,guardsFocus:i,modalFocus:h,closeOnFocusOut:u,offset:m=4,portalRoot:c,portalId:s}){const[f,d]=re(!1,"root"),{x:O,y:b,reference:R,floating:w,strategy:E,context:v,refs:g}=Q({placement:n,middleware:[U(m),H(),V({padding:{left:8,right:8}})],open:f,onOpenChange:l=>{l&&typeof o=="function"&&o(),!l&&typeof t=="function"&&t(),d(l)},whileElementsMounted:W}),{getReferenceProps:p,getFloatingProps:k}=X([Y(v),$(v,{bubbles:!1,escapeKey:!1}),oe(v)]),y=A(()=>d(!1),[d]),N=A(()=>d(!0),[d]),_=C(null),T=I([_,w]),{root:M,id:S}=ee({root:c,portalId:s,fallbackPortalId:"--cui-popover-portal"});return{getReferenceProps:p,reference:R,render:l=>e(be,{root:M,id:S,children:e(B,{in:f,mountOnEnter:!0,unmountOnExit:!0,timeout:250,nodeRef:_,children:j=>e(Z,{context:v,initialFocus:r??w,guards:i,modal:h,closeOnFocusOut:u,children:_e(a,{ref:T,state:j,offset:m,...k({style:{position:E,top:b??0,left:O??0}})},l)})})}),isShown:f,refs:g,close:y,open:N}}export{J as GenericPopover,Re as Popover,ne as PopoverTitle,Ee as usePopover,Ce as usePopoverContext};
//# sourceMappingURL=index.js.map
