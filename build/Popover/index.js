import{jsx as e,jsxs as z,Fragment as Oe}from"react/jsx-runtime";import{forwardRef as A,useRef as x,useEffect as be,createContext as U,useContext as Y,useState as B,useCallback as H,useImperativeHandle as Fe,cloneElement as we,createElement as Ne}from"react";import{useMergeRefs as O,useFloatingTree as Ce,useFloatingNodeId as Re,useFloating as $,offset as G,flip as V,shift as W,autoUpdate as X,useInteractions as Z,useClick as ee,useDismiss as oe,FloatingNode as Ie,FloatingOverlay as Ee,FloatingFocusManager as re,FloatingPortal as ke}from"@floating-ui/react";import b from"classnames";import{Transition as J}from"react-transition-group";import{useFloatingContext as te,FloatingTreeWrapper as De}from"../FloatingProvider/index.js";import{useCustomDismiss as ne}from"../hooks/useCustomDismiss.js";import{useLockedBody as le}from"../hooks/useLockedBody.js";var F={wrapper:"Popover-module_wrapper__m7aDv",body:"Popover-module_body__ytz0O",popover_appear:"Popover-module_popover_appear__dJaAP",disappear:"Popover-module_disappear__w-dyh",popover_disappear:"Popover-module_popover_disappear__taph3",overlay:"Popover-module_overlay__u9dvj",overlay_appear:"Popover-module_overlay_appear__b1qOJ",overlay_disappear:"Popover-module_overlay_disappear__tQSBY"};const K=A(function({className:o,children:r,wrapperClassName:l,state:n,offset:t,...s},h){const m=x(null),f=O([h,m]);return be(()=>{var c;const a=m.current;return a&&t&&typeof t!="function"&&a.style.setProperty("--offset",`${typeof t=="number"?t:(c=t.mainAxis)!=null?c:4}px`),()=>{a&&a.style.setProperty("--offset","4px")}},[t]),e("div",{ref:f,className:b(F.wrapper,l,{[F.disappear]:n==="exiting"||n==="exited"}),...s,children:e("div",{className:b("panel panel--bordered panel--raised",F.body,o),tabIndex:-1,children:r})})}),ae=U(null),Me=({children:o,...r})=>e(ae.Provider,{value:r,children:o}),Te=()=>Y(ae),Se=({show:o,children:r,background:l="var(--cui-background-color)",className:n})=>{const t=x(null);return e(J,{in:o,mountOnEnter:!0,unmountOnExit:!0,timeout:250,nodeRef:t,children:s=>e("div",{style:{background:l},className:b(F.overlay,n,{[F.disappear]:s==="exiting"||s==="exited"}),ref:t,children:r})})},se=U(null),je=()=>{const o=Y(se);if(o)return o.current},ze=A(function({children:o,element:r,onClose:l,onOpen:n,showClassName:t,overlay:s,showOverlay:h,placement:m,portalRoot:f,offset:c=4,closeRef:a,initialFocus:v,guardsFocus:d,modalFocus:w,closeOnFocusOut:N,portalId:E,wrapperClassName:C,className:k,explicitPortal:u,autoDismiss:D=!0,overlayProps:M},T){const[g,i]=le(!1,"root"),[y,S]=B(D),j=Ce(),_=Re(),{x:p,y:R,reference:pe,floating:ce,strategy:de,context:I}=$({placement:m,middleware:[G(c),V(),W({padding:{left:8,right:8}})],open:g,onOpenChange:P=>{P&&typeof n=="function"&&n(),!P&&typeof l=="function"&&l(),i(P)},whileElementsMounted:X,nodeId:_}),{getReferenceProps:ue,getFloatingProps:me}=Z([ee(I),oe(I,{escapeKey:!1,bubbles:!1,enabled:y}),ne(I,{enabled:y})]),[fe,ve]=B(h),[he,ge]=B(s),ye=O([pe,r.ref]),q=x(null),L=O([q,ce]),{root:_e,id:Pe}=te({root:f,portalId:E,fallbackPortalId:"--cui-popover-portal"}),xe=H(()=>i(!1),[i]);a&&(a.current=xe);const Q=x(null);return Fe(O([T,Q]),()=>({close:()=>i(!1),open:()=>i(!0),setAutoDismiss:S}),[i]),z(se.Provider,{value:Q,children:[we(r,ue({ref:ye,...r.props,className:b(r.props.className,t?{[t]:g}:void 0)})),e(De,{withPortal:u||!j,portalId:Pe,portalRoot:_e,force:u?!0:void 0,children:e(Ie,{id:_,children:e(J,{in:g,mountOnEnter:!0,unmountOnExit:!0,timeout:250,nodeRef:q,children:P=>e(Ee,{style:{zIndex:"calc(var(--cui-max-zindex, 1000) + 2)"},...M,id:_,children:e(re,{context:I,initialFocus:v??L,guards:d,modal:w,closeOnFocusOut:N,children:e(K,{ref:L,style:{position:de,top:R??0,left:p??0},state:P,offset:c,wrapperClassName:C,...me({className:k}),children:z(Me,{setOverlayState:ve,setOverlay:ge,children:[e(Se,{show:fe||!1,children:he}),o]})})})})})})})]})}),ie=A(({className:o,noLine:r,...l},n)=>z(Oe,{children:[e("h5",{ref:n,className:b("no-margin-bottom",o),...l}),!r&&e("hr",{className:"half-margin-top"})]}));ie.displayName="PopoverTitle";function Ae({onClose:o,onOpen:r,popoverComponent:l=K,placement:n,initialFocus:t,guardsFocus:s,modalFocus:h,closeOnFocusOut:m,offset:f=4,portalRoot:c,portalId:a}){const[v,d]=le(!1,"root"),{x:w,y:N,reference:E,floating:C,strategy:k,context:u,refs:D}=$({placement:n,middleware:[G(f),V(),W({padding:{left:8,right:8}})],open:v,onOpenChange:p=>{p&&typeof r=="function"&&r(),!p&&typeof o=="function"&&o(),d(p)},whileElementsMounted:X}),{getReferenceProps:M,getFloatingProps:T}=Z([ee(u),oe(u,{bubbles:!1,escapeKey:!1}),ne(u)]),g=H(()=>d(!1),[d]),i=H(()=>d(!0),[d]),y=x(null),S=O([y,C]),{root:j,id:_}=te({root:c,portalId:a,fallbackPortalId:"--cui-popover-portal"});return{getReferenceProps:M,reference:E,render:p=>e(ke,{root:j,id:_,children:e(J,{in:v,mountOnEnter:!0,unmountOnExit:!0,timeout:250,nodeRef:y,children:R=>e(re,{context:u,initialFocus:t??C,guards:s,modal:h,closeOnFocusOut:m,children:Ne(l,{ref:S,state:R,offset:f,...T({style:{position:k,top:N??0,left:w??0}})},p)})})}),isShown:v,refs:D,close:g,open:i}}export{K as GenericPopover,ze as Popover,ie as PopoverTitle,Ae as usePopover,Te as usePopoverContext,je as usePopoverHandlers};
//# sourceMappingURL=index.js.map
